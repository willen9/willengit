<script type="text/javascript">
    $(document).ready(function () {
        $('#from-PurchasedSerial').bootstrapValidator({
            fields: {
                ProductNo: {
                    validators: {
                        notEmpty: {
                            message: '品號不能為空！'
                        }
                    }
                },
                SerialNo: {
                    validators: {
                        notEmpty: {
                            message: '序號不能為空！'
                        },
                        callback: {
                            message: '輸入的商品序號已存在，請重新輸入!',
                            callback: function (value, validator) {
                                var res = true;
                                if (value != "") {
                                    $.ajax({
                                        url: '@Url.Action("SerialNo", "Main")',
                                        data: JSON.stringify({ "SerialNo": value }),
                                        type: 'POST',
                                        async: false,
                                        contentType: 'application/json; charset=utf-8',
                                        success: function (data) {
                                            if (data == false) {
                                                res = false;
                                            }
                                        }
                                    })
                                }
                                return res;
                            }
                        }
                    }
                }
            }
        });

        $("#id_OrderDate").datetimepicker({
            format: 'yyyy/mm/dd',
            autoclose: 1,
            forceParse: 1,
            startView: 2,
            minView: 2,
            todayBtn: 1,
            todayHighlight: 1
        });

        $("#id_PCompletionDate").datetimepicker({
            format: 'yyyy/mm/dd',
            autoclose: 1,
            forceParse: 1,
            startView: 2,
            minView: 2,
            todayBtn: 1,
            todayHighlight: 1
        });

    });

    $(function () {
        $('#id_RGAType').blur(function () {
            if (document.getElementById("id_RGAType").readOnly == true) {
                return;
            }
            if ($("#id_RGAType").val().trim() != "") {
                $.ajax({
                    url: '@Url.Action("GetOrderTypeName", "Main", new { Area = "CONI01" })',
                    data: JSON.stringify({ "OrderType": $("#id_RGAType").val().trim(), "OrderCategory": "B2" }),
                    type: 'POST',
                    contentType: 'application/json; charset=utf-8',
                    success: function (data) {
                        $('#ordersname').text(data.OrderSName);
                        var Edate = new Date($("#id_OrderDate").val());
                        Edate.setDate(Edate.getDate() + parseInt(data.DaysAfterCreate));
                        var year = Edate.getFullYear();//当前年份
                        var month = Edate.getMonth() + 1;//当前月份
                        var day = Edate.getDate();//当前日
                        if (month.toString().length == 1) {
                            month = "0" + month;
                        }
                        if (day.toString().length == 1) {
                            day = "0" + day;
                        }
                        $("#id_PCompletionDate").val(year + "/" + month + "/" + day);
                        $.ajax({
                            url: '@Url.Action("GetOrderTypeNo", "Main",new { Area = "SUPI05"})',
                            data: JSON.stringify({ "OrderType": $("#id_RGAType").val().trim() }),
                            type: 'POST',
                            contentType: 'application/json; charset=utf-8',
                            success: function (data) {
                                var strData = data.split('-');
                                if (strData[0] == "YES") {
                                    $('#id_RGANo').val(strData[1]);
                                    document.getElementById("id_RGANo").readOnly = "readonly";
                                } else if (strData[0] == "NO") {
                                    $('#id_RGANo').val(strData[1]);
                                    document.getElementById("id_RGANo").readOnly = "";
                                }else
                                {
                                    $("#msg_information").html(strData[1]);
                                    $('.msg-modal-lg').modal();
                                    $('#id_RGANo').val("");
                                    document.getElementById("id_RGANo").readOnly = "";
                                }
                            }
                        })
                    },
                    error: function () {
                        $("#msg_information").html("單別不存在！");
                        $('.msg-modal-lg').modal();
                        $("#id_RGAType").val("")
                        $('#ordersname').text("");
                        $('#id_RGANo').val("");
                        $('#id_PCompletionDate').val("");
                        return;
                    }
                })
            } else {
                $("#id_RGAType").val("")
                $('#ordersname').text("");
                $('#id_RGANo').val("");
                $('#id_PCompletionDate').val("");
            }
        });
        $("#btnRGAType").click(function () {
            $.ajax({
                url: '@Url.Action("SearchOrderType", "Main", new { Area = "CONI01" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "Col": ",OrderCategory", "Condition": ",=", "conditionValue": ",B2", Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divOrderCategoryGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divOrderCategoryGrid table tbody").append("<tr>" +
                            "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectOrderType(this)'>選擇</a>" +
                            "<td class='OrderTypeType'>" + Maintain[i].OrderType + "</td>" +
                            "<td class='OrderSNameType'>" + Maintain[i].OrderSName + "</td>" +
                            "<td><input type='hidden' class='OrderCategoryType' name='version' value='" + Maintain[i].OrderCategoryID + "'>" + "</td>" +
                            "<td><input type='hidden' class='OrderFNameType' name='version' value='" + Maintain[i].OrderFName + "'>" + "</td>" +
                            "<td><input type='hidden' class='CodeModeType' name='version' value='" + Maintain[i].CodeMode + "'>" + "</td>" +
                            "<td><input type='hidden' class='SerialNrCodeLengthType' name='version' value='" + Maintain[i].SerialNrCodeLength + "'>" + "</td>" +
                            "<td><input type='hidden' class='AutoConfirmType' name='version' value='" + Maintain[i].AutoConfirm + "'>" + "</td>" +
                            "<td><input type='hidden' class='CheckExOrderType' name='version' value='" + Maintain[i].CheckExOrder + "'>" + "</td>" +
                            "<td><input type='hidden' class='RemarkType' name='version' value='" + Maintain[i].Remark + "'>" + "</td>" +
                            "<td><input type='hidden' class='DaysAfterCreateType' name='version' value='" + Maintain[i].DaysAfterCreate + "'>" + "</td>" +
                            "</tr>");
                    }
                }
            });
            $("#txtOrderType").val("");
            $("#txtOrderSName").val("");
            $("#OrderCategoryPage").val("1");
            $(".record-selector-orderCategory-modal").modal();

        });

        $("#btnOrderTypeInfo").click(function () {
            $.ajax({
                url: '@Url.Action("SearchOrderType", "Main", new { Area = "CONI01" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "OrderType": $("#txtOrderType").val(), "OrderSName": $("#txtOrderSName").val(), "OrderCategory": "B2", Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divOrderCategoryGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divOrderCategoryGrid table tbody").append("<tr>" +
                            "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectOrderType(this)'>選擇</a>" +
                            "<td class='OrderTypeType'>" + Maintain[i].OrderType + "</td>" +
                            "<td class='OrderSNameType'>" + Maintain[i].OrderSName + "</td>" +
                            "<td><input type='hidden' class='OrderCategoryType' name='version' value='" + Maintain[i].OrderCategoryID + "'>" + "</td>" +
                            "<td><input type='hidden' class='OrderFNameType' name='version' value='" + Maintain[i].OrderFName + "'>" + "</td>" +
                            "<td><input type='hidden' class='CodeModeType' name='version' value='" + Maintain[i].CodeMode + "'>" + "</td>" +
                            "<td><input type='hidden' class='SerialNrCodeLengthType' name='version' value='" + Maintain[i].SerialNrCodeLength + "'>" + "</td>" +
                            "<td><input type='hidden' class='AutoConfirmType' name='version' value='" + Maintain[i].AutoConfirm + "'>" + "</td>" +
                            "<td><input type='hidden' class='CheckExOrderType' name='version' value='" + Maintain[i].CheckExOrder + "'>" + "</td>" +
                            "<td><input type='hidden' class='RemarkType' name='version' value='" + Maintain[i].Remark + "'>" + "</td>" +
                            "<td><input type='hidden' class='DaysAfterCreateType' name='version' value='" + Maintain[i].DaysAfterCreate + "'>" + "</td>" +
                            "</tr>");
                    }
                }
            });
            $("#OrderCategoryPage").val("1");
        });

        $("#divOrderCategoryGrid").scroll(function () {
            var Page = document.getElementById("OrderCategoryPage").value;;
            if (Page != 0) {
                var scrollTop = $(this).scrollTop();
                //var scrollHeight = $(document).height();
                //var windowHeight = $(this).height();
                if (scrollTop + 500 >= (870 - 370) * (Page - 1)) {
                    //此处是滚动条到底部时候触发的事件，在这里写要加载的数据，或者是拉动滚动条的操作
                    Page = parseInt(Page) + 1;
                    $.ajax({
                        url: '@Url.Action("SearchOrderType", "Main", new { Area = "CONI01" })',
                        type: "POST",
                        datatype: 'JSON',
                        data: JSON.stringify({ "OrderType": $("#txtOrderType").val(), "OrderSName": $("#txtOrderSName").val(), "OrderCategory": "B2", Page: Page }),
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            var Maintain = eval(data);
                            for (var i = 0; i < Maintain.length; i++) {
                                $("#divOrderCategoryGrid table tbody").append("<tr>" +
                                    "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectOrderType(this)'>選擇</a>" +
                                    "<td class='OrderTypeType'>" + Maintain[i].OrderType + "</td>" +
                                    "<td class='OrderSNameType'>" + Maintain[i].OrderSName + "</td>" +
                                    "<td><input type='hidden' class='OrderCategoryType' name='version' value='" + Maintain[i].OrderCategoryID + "'>" + "</td>" +
                                    "<td><input type='hidden' class='OrderFNameType' name='version' value='" + Maintain[i].OrderFName + "'>" + "</td>" +
                                    "<td><input type='hidden' class='CodeModeType' name='version' value='" + Maintain[i].CodeMode + "'>" + "</td>" +
                                    "<td><input type='hidden' class='SerialNrCodeLengthType' name='version' value='" + Maintain[i].SerialNrCodeLength + "'>" + "</td>" +
                                    "<td><input type='hidden' class='AutoConfirmType' name='version' value='" + Maintain[i].AutoConfirm + "'>" + "</td>" +
                                    "<td><input type='hidden' class='CheckExOrderType' name='version' value='" + Maintain[i].CheckExOrder + "'>" + "</td>" +
                                    "<td><input type='hidden' class='RemarkType' name='version' value='" + Maintain[i].Remark + "'>" + "</td>" +
                                    "<td><input type='hidden' class='DaysAfterCreateType' name='version' value='" + Maintain[i].DaysAfterCreate + "'>" + "</td>" +
                                    "</tr>");
                            }
                        }
                    });
                    $("#OrderCategoryPage").val(Page);
                }
            }

        });

        $('#id_CustomerId').blur(function () {
            if (document.getElementById("id_CustomerId").readOnly == true) {
                return;
            }
            if ($("#id_CustomerId").val().trim() != "") {
                $.ajax({
                    url: '@Url.Action("SearchCustomerInfo", "Main", new { Area = "CONI02" })',
                    data: JSON.stringify({ "CustomerId": $("#id_CustomerId").val().trim() }),
                    type: 'POST',
                    contentType: 'application/json; charset=utf-8',
                    success: function (data) {
                        $('#id_CustomerId').val(data.CustomerId);
                        $('#customername').html(data.CustomerName);
                        $('#id_CustomerType').val(data.CustomerType);
                        $('#id_Contact').val(data.Contact);
                        $('#id_TelNo').val(data.TelNo);
                        $('#id_FaxNo').val(data.FaxNo);
                        $('#id_AddressSName').val("");
                        $('#id_Address').val("");
                    },
                    error: function () {
                        $("#msg_information").html("客戶不存在！");
                        $('.msg-modal-lg').modal();
                        $('#id_CustomerId').val("");
                        $('#customername').html("");
                        $('#id_CustomerType').val("");
                        $('#id_AddressSName').val("");
                        $('#id_Address').val("");
                        $('#id_Contact').val("");
                        $('#id_TelNo').val("");
                        $('#id_FaxNo').val("");
                        return;
                    }
                })
            } else {
                $('#id_CustomerId').val("");
                $('#customername').html("");
                $('#id_CustomerType').val("");
                $('#id_AddressSName').val("");
                $('#id_Address').val("");
                $('#id_Contact').val("");
                $('#id_TelNo').val("");
                $('#id_FaxNo').val("");
            }
        });

        $("#btnCustomerId").click(function () {
            $.ajax({
                url: '@Url.Action("SearchCustomer", "Main", new { Area = "CONI02" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "CustomerId": $("#id_CustomerId").val().trim(), "Col": "", "Condition": "", "conditionValue": "", Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divCustGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divCustGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectCustomer(this)'>選擇</a>" +
                                "<td class='CustomerIdType'>" + Maintain[i].CustomerId + "</td>" +
                                "<td class='CustomerNameType'>" + Maintain[i].CustomerName + "</td>" +
                                "<td class='CustomerTypeType'>" + Maintain[i].CustomerType + "</td>" +
                                "<td class='ContactType'>" + Maintain[i].Contact + "</td>" +
                                "<td class='TelNoType'>" + Maintain[i].TelNo + "</td>" +
                                "<td class='SalesType'>" + Maintain[i].SalesName + "</td><td><input type='hidden' class='SalesIDType' name='sales' value='"
                                + Maintain[i].Sales + "'>" + "</td>" +
                                "<td><input type='hidden' class='CurrencyIdType' name='version' value='" + Maintain[i].CurrencyId + "'>" + "</td>" +
                                "<td><input type='hidden' class='TaxRateType' name='version' value='" + Maintain[i].TaxRate + "'>" + "</td>" +
                                "<td><input type='hidden' class='FaxNoType' name='version' value='" + Maintain[i].FaxNo + "'>" + "</td>" +
                                "<td><input type='hidden' class='EmailType' name='version' value='" + Maintain[i].Email + "'>" + "</td>" +
                                "<td><input type='hidden' class='AddressSNameType' name='version' value='" + Maintain[i].AddressSName + "'>" + "</td>" +
                                "<td><input type='hidden' class='AddressType' name='version' value='" + Maintain[i].Address + "'>" + "</td>" +
                                "<td><input type='hidden' class='RemarkType' name='version' value='" + Maintain[i].Remark + "'>" + "</td>" +
                                "<td><input type='hidden' class='CustomerFNameType' name='version' value='" + Maintain[i].CustomerFName + "'>" + "</td>" +
                                "</tr>");

                    }
                }
            });
            $("#txtCustomerId").val($("#id_CustomerId").val().trim());
            $("#txtCustomerName").val("");
            $("#CustPage").val("1");
            $(".record-selector-customer-modal").modal();
        });

        $("#btncustomerInfo").click(function () {
            $.ajax({
                url: '@Url.Action("SearchCustomer", "Main", new { Area = "CONI02" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "CustomerId": $("#txtCustomerId").val(), "Col": $("#addCustomer_Col").val(), "Condition": $("#addCustomer_Condition").val(), "conditionValue": $("#addCustomer_conditionValue").val(), Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divCustGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divCustGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectCustomer(this)'>選擇</a>" +
                                "<td class='CustomerIdType'>" + Maintain[i].CustomerId + "</td>" +
                                "<td class='CustomerNameType'>" + Maintain[i].CustomerName + "</td>" +
                                "<td class='CustomerTypeType'>" + Maintain[i].CustomerType + "</td>" +
                                "<td class='ContactType'>" + Maintain[i].Contact + "</td>" +
                                "<td class='TelNoType'>" + Maintain[i].TelNo + "</td>" +
                                "<td class='SalesType'>" + Maintain[i].SalesName + "</td><td><input type='hidden' class='SalesIDType' name='sales' value='"
                                + Maintain[i].Sales + "'>" + "</td>" +
                                "<td><input type='hidden' class='CurrencyIdType' name='version' value='" + Maintain[i].CurrencyId + "'>" + "</td>" +
                                "<td><input type='hidden' class='TaxRateType' name='version' value='" + Maintain[i].TaxRate + "'>" + "</td>" +
                                "<td><input type='hidden' class='FaxNoType' name='version' value='" + Maintain[i].FaxNo + "'>" + "</td>" +
                                "<td><input type='hidden' class='EmailType' name='version' value='" + Maintain[i].Email + "'>" + "</td>" +
                                "<td><input type='hidden' class='AddressSNameType' name='version' value='" + Maintain[i].AddressSName + "'>" + "</td>" +
                                "<td><input type='hidden' class='AddressType' name='version' value='" + Maintain[i].Address + "'>" + "</td>" +
                                "<td><input type='hidden' class='RemarkType' name='version' value='" + Maintain[i].Remark + "'>" + "</td>" +
                                "<td><input type='hidden' class='CustomerFNameType' name='version' value='" + Maintain[i].CustomerFName + "'>" + "</td>" +
                                "</tr>");
                    }
                }
            });
            $("#CustPage").val("1");
        });

        $("#divCustGrid").scroll(function () {
            var Page = document.getElementById("CustPage").value;;
            if (Page != 0) {
                var scrollTop = $(this).scrollTop();
                //var scrollHeight = $(document).height();
                //var windowHeight = $(this).height();
                if (scrollTop + 500 >= (870 - 370) * (Page - 1)) {
                    //此处是滚动条到底部时候触发的事件，在这里写要加载的数据，或者是拉动滚动条的操作
                    Page = parseInt(Page) + 1;
                    $.ajax({
                        url: '@Url.Action("SearchCustomer", "Main", new { Area = "CONI02" })',
                        type: "POST",
                        datatype: 'JSON',
                        data: JSON.stringify({ "CustomerId": $("#txtCustomerId").val(), "Col": $("#addCustomer_Col").val(), "Condition": $("#addCustomer_Condition").val(), "conditionValue": $("#addCustomer_conditionValue").val(), Page: Page }),
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            var Maintain = eval(data);
                            for (var i = 0; i < Maintain.length; i++) {
                                $("#divCustGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectCustomer(this)'>選擇</a>" +
                                "<td class='CustomerIdType'>" + Maintain[i].CustomerId + "</td>" +
                                "<td class='CustomerNameType'>" + Maintain[i].CustomerName + "</td>" +
                                "<td class='CustomerTypeType'>" + Maintain[i].CustomerType + "</td>" +
                                "<td class='ContactType'>" + Maintain[i].Contact + "</td>" +
                                "<td class='TelNoType'>" + Maintain[i].TelNo + "</td>" +
                                "<td class='SalesType'>" + Maintain[i].SalesName + "</td><td><input type='hidden' class='SalesIDType' name='sales' value='"
                                + Maintain[i].Sales + "'>" + "</td>" +
                                "<td><input type='hidden' class='CurrencyIdType' name='version' value='" + Maintain[i].CurrencyId + "'>" + "</td>" +
                                "<td><input type='hidden' class='TaxRateType' name='version' value='" + Maintain[i].TaxRate + "'>" + "</td>" +
                                "<td><input type='hidden' class='FaxNoType' name='version' value='" + Maintain[i].FaxNo + "'>" + "</td>" +
                                "<td><input type='hidden' class='EmailType' name='version' value='" + Maintain[i].Email + "'>" + "</td>" +
                                "<td><input type='hidden' class='AddressSNameType' name='version' value='" + Maintain[i].AddressSName + "'>" + "</td>" +
                                "<td><input type='hidden' class='AddressType' name='version' value='" + Maintain[i].Address + "'>" + "</td>" +
                                "<td><input type='hidden' class='RemarkType' name='version' value='" + Maintain[i].Remark + "'>" + "</td>" +
                                "<td><input type='hidden' class='CustomerFNameType' name='version' value='" + Maintain[i].CustomerFName + "'>" + "</td>" +
                                "</tr>");
                            }
                        }
                    });
                    $("#CustPage").val(Page);
                }
            }

        });

        $("#btnAddressSName").click(function () {
            if ($("#id_CustomerId").val().trim() == "") {
                $("#msg_information").html("請先選擇客戶！");
                $('.msg-modal-lg').modal();
                return;
            }
            $.ajax({
                url: '@Url.Action("SearchCustomerAddress", "Main", new { Area = "CONI02" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "Col": ",CustomerId", "Condition": ",=", "conditionValue": "," + $("#id_CustomerId").val().trim(), Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divCustomerAddressGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divCustomerAddressGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectAddress(this)'>選擇</a>" +
                                "<td class='AddressIdType'>" + Maintain[i].AddressId + "</td>" +
                                "<td class='Address1Type'>" + Maintain[i].AddressSName + "</td>" +
                                "<td class='Address2Type'>" + Maintain[i].Address + "</td>" +
                                "<td class='ContactType'>" + Maintain[i].Contact + "</td>" +
                                "<td class='TelNoType'>" + Maintain[i].TelNo + "</td>" +
                                "<td class='FaxNoType'>" + Maintain[i].FaxNo + "</td>" +
                                "<td class='RemarkType'>" + Maintain[i].Remark + "</td>" +
                                "</tr>");

                    }
                }
            });
            $("#txtAddressId").val("");
            $("#txtAddress1").val($("#id_AddressSName").val().trim());
            $("#CustomerAddressPage").val("1");
            $(".record-selector-customeraddress-modal").modal();
        });

        $("#btnAddressInfo").click(function () {
            $.ajax({
                url: '@Url.Action("SearchCustomerAddress", "Main", new { Area = "SUPI05" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "CustomerId": $("#CustomerId").val(), "Col": $("#addAddress_Col").val(), "Condition": $("#addAddress_Condition").val(), "conditionValue": $("#addAddress_conditionValue").val(), Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divCustomerAddressGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divCustomerAddressGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectAddress(this)'>選擇</a>" +
                                "<td class='AddressIdType'>" + Maintain[i].AddressId + "</td>" +
                                "<td class='Address1Type'>" + Maintain[i].AddressSName + "</td>" +
                                "<td class='Address2Type'>" + Maintain[i].Address + "</td>" +
                                "<td class='ContactType'>" + Maintain[i].Contact + "</td>" +
                                "<td class='TelNoType'>" + Maintain[i].TelNo + "</td>" +
                                "<td class='FaxNoType'>" + Maintain[i].FaxNo + "</td>" +
                                "<td class='RemarkType'>" + Maintain[i].Remark + "</td>" +
                                "</tr>");
                    }
                }
            });
            $("#CustomerAddressPage").val("1");
        });

        $("#divCustomerAddressGrid").scroll(function () {
            var Page = document.getElementById("CustomerAddressPage").value;;
            if (Page != 0) {
                var scrollTop = $(this).scrollTop();
                //var scrollHeight = $(document).height();
                //var windowHeight = $(this).height();
                if (scrollTop + 500 >= (870 - 370) * (Page - 1)) {
                    //此处是滚动条到底部时候触发的事件，在这里写要加载的数据，或者是拉动滚动条的操作
                    Page = parseInt(Page) + 1;
                    $.ajax({
                        url: '@Url.Action("SearchCustomerAddress", "Main",new { Area = "SUPI05" })',
                        type: "POST",
                        datatype: 'JSON',
                        data: JSON.stringify({ "CustomerId": $("#CustomerId").val(), "Col": $("#addAddress_Col").val(), "Condition": $("#addAddress_Condition").val(), "conditionValue": $("#addAddress_conditionValue").val(), Page: Page }),
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            var Maintain = eval(data);
                            for (var i = 0; i < Maintain.length; i++) {
                                $("#divCustomerAddressGrid table tbody").append("<tr>" +
                                    "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectAddress(this)'>選擇</a>" +
                                    "<td class='AddressIdType'>" + Maintain[i].AddressId + "</td>" +
                                    "<td class='Address1Type'>" + Maintain[i].AddressSName + "</td>" +
                                    "<td class='Address2Type'>" + Maintain[i].Address + "</td>" +
                                    "<td class='ContactType'>" + Maintain[i].Contact + "</td>" +
                                    "<td class='TelNoType'>" + Maintain[i].TelNo + "</td>" +
                                    "<td class='FaxNoType'>" + Maintain[i].FaxNo + "</td>" +
                                    "<td class='RemarkType'>" + Maintain[i].Remark + "</td>" +
                                    "</tr>");
                            }
                        }
                    });
                    $("#CustomerAddressPage").val(Page);
                }
            }

        });

        $('#id_ProductNo').blur(function () {
            if (document.getElementById("id_ProductNo").readOnly == true) {
                return;
            }
            if ($("#id_ProductNo").val().trim() != "") {
                $.ajax({
                    url: '@Url.Action("SearchProductInfo", "Main")',
                    data: JSON.stringify({ "ProductNo": $("#id_ProductNo").val().trim() }),
                    type: 'POST',
                    contentType: 'application/json; charset=utf-8',
                    success: function (data) {
                        $("#id_ProductNo").val(data.ProductNo);        //品號
                        $("#id_ProductName").val(data.ProductName);     //品名
                    },
                    error: function () {
                        $("#msg_information").html("品號不存在！");
                        $('.msg-modal-lg').modal();
                        $("#id_ProductNo").val("");        //品號
                        $("#id_ProductName").val("");     //品名
                    }
                })
            } else {
                $("#id_ProductNo").val("");        //品號
                $("#id_ProductName").val("");     //品名
            }
        });

        $("#btnProductNo").click(function () {
            $.ajax({
                url: '@Url.Action("SearchProduct", "Main", new { Area = "CONI02" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "ProductNo": $("#id_ProductNo").val(), "Col": "", "Condition": "", "conditionValue": "", Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divProductGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divProductGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectProduct(this)'>選擇</a>" +
                                "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                                "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                                "<td class='SpecificationType'>" + Maintain[i].Specification + "</td>" +
                                "<td class='UnitType'>" + Maintain[i].Unit + "</td>" +
                                "<td class='ProductTypeId1NameType'>" + Maintain[i].ProductTypeId1Name + "</td>" +
                                "<td class='VendorNameType'>" + Maintain[i].VendorName + "</td>" +
                                "</tr>");

                    }
                }
            });
            $("#txtProductNo").val($("#id_ProductNo").val());
            $("#txtProductName").val("");
            $("#ProductPage").val("1");
            $(".record-selector-product-modal").modal();
        });

        $("#btnSearchProduct").click(function () {
            $.ajax({
                url: '@Url.Action("SearchProduct", "Main",new { Area = "CONI02" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "ProductNo": $("#txtProductNo").val(), "Col": $("#addProduct_Col").val(), "Condition": $("#addProduct_Condition").val(), "conditionValue": $("#addProduct_conditionValue").val(), Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divProductGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divProductGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectProduct(this)'>選擇</a>" +
                                "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                                "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                                "<td class='SpecificationType'>" + Maintain[i].Specification + "</td>" +
                                "<td class='UnitType'>" + Maintain[i].Unit + "</td>" +
                                "<td class='ProductTypeId1NameType'>" + Maintain[i].ProductTypeId1Name + "</td>" +
                                "<td class='VendorNameType'>" + Maintain[i].VendorName + "</td>" +
                                "</tr>");
                    }
                }
            });
            $("#ProductPage").val("1");
        });

        $("#divProductGrid").scroll(function () {
            var Page = document.getElementById("ProductPage").value;;
            if (Page != 0) {
                var scrollTop = $(this).scrollTop();
                //var scrollHeight = $(document).height();
                //var windowHeight = $(this).height();
                if (scrollTop + 500 >= (870 - 370) * (Page - 1)) {
                    //此处是滚动条到底部时候触发的事件，在这里写要加载的数据，或者是拉动滚动条的操作
                    Page = parseInt(Page) + 1;
                    $.ajax({
                        url: '@Url.Action("SearchProduct", "Main", new { Area = "CONI02" })',
                        type: "POST",
                        datatype: 'JSON',
                        data: JSON.stringify({ "ProductNo": $("#txtProductNo").val(), "Col": $("#addProduct_Col").val(), "Condition": $("#addProduct_Condition").val(), "conditionValue": $("#addProduct_conditionValue").val(), Page: Page }),
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            var Maintain = eval(data);
                            for (var i = 0; i < Maintain.length; i++) {
                                $("#divProductGrid table tbody").append("<tr>" +
                                    "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectProduct(this)'>選擇</a>" +
                                    "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                                    "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                                    "<td class='SpecificationType'>" + Maintain[i].Specification + "</td>" +
                                    "<td class='UnitType'>" + Maintain[i].Unit + "</td>" +
                                    "<td class='ProductTypeId1NameType'>" + Maintain[i].ProductTypeId1Name + "</td>" +
                                    "<td class='VendorNameType'>" + Maintain[i].VendorName + "</td>" +
                                    "</tr>");
                            }
                        }
                    });
                    $("#ProductPage").val(Page);
                }
            }

        });

        $("#btnContact").click(function () {
            if ($("#id_CustomerId").val().trim() == "") {
                $("#msg_information").html("請先選擇客戶！");
                $('.msg-modal-lg').modal();
                return;
            }
            $.ajax({
                url: '@Url.Action("SearchCustomerContact", "Main", new { Area = "CONI02" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "Col": ",CustomerId", "Condition": ",=", "conditionValue": "," + $("#id_CustomerId").val(), Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divContacttGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divContacttGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectContact(this)'>選擇</a>" +
                                "<td class='ContactIdType'>" + Maintain[i].ContactId + "</td>" +
                                "<td class='ContactType'>" + Maintain[i].Contact + "</td>" +
                                "<td class='DepartmentType'>" + Maintain[i].Department + "</td>" +
                                "<td class='OccupationType'>" + Maintain[i].Occupation + "</td>" +
                                "<td class='TelNoType'>" + Maintain[i].TelNo + "</td>" +
                                "<td class='FaxNoType'>" + Maintain[i].FaxNo + "</td>" +
                                "<td class='EmailType'>" + Maintain[i].Email + "</td>" +
                                "<td class='RemarkType'>" + Maintain[i].Remark + "</td>" +
                                "</tr>");

                    }
                }
            });
            $("#id_txtCondition").val("");
            $("#id_txtContact").val($("#id_Contact").val().trim());
            $("#ContactPage").val("1");
            $(".record-selector-contact-modal").modal();
        });

        $("#btnSearchContact").click(function () {
            $.ajax({
                url: '@Url.Action("SearchCustomerContact", "Main", new { Area = "CONI02" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "CustomerId": $("#CustomerId").val(), "Col": $("#addContact_Col").val(), "Condition": $("#addContact_Condition").val(), "conditionValue": $("#addContact_conditionValue").val(), Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divContacttGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divContacttGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectContact(this)'>選擇</a>" +
                                "<td class='ContactIdType'>" + Maintain[i].ContactId + "</td>" +
                                "<td class='ContactType'>" + Maintain[i].Contact + "</td>" +
                                "<td class='DepartmentType'>" + Maintain[i].Department + "</td>" +
                                "<td class='OccupationType'>" + Maintain[i].Occupation + "</td>" +
                                "<td class='TelNoType'>" + Maintain[i].TelNo + "</td>" +
                                "<td class='FaxNoType'>" + Maintain[i].FaxNo + "</td>" +
                                "<td class='EmailType'>" + Maintain[i].Email + "</td>" +
                                "<td class='RemarkType'>" + Maintain[i].Remark + "</td>" +
                                "</tr>");
                    }
                }
            });
            $("#ContactPage").val("1");
        });

        $("#divContacttGrid").scroll(function () {
            var Page = document.getElementById("ContactPage").value;;
            if (Page != 0) {
                var scrollTop = $(this).scrollTop();
                //var scrollHeight = $(document).height();
                //var windowHeight = $(this).height();
                if (scrollTop + 500 >= (870 - 370) * (Page - 1)) {
                    //此处是滚动条到底部时候触发的事件，在这里写要加载的数据，或者是拉动滚动条的操作
                    Page = parseInt(Page) + 1;
                    $.ajax({
                        url: '@Url.Action("SearchCustomerContact", "Main", new { Area = "CONI02" })',
                        type: "POST",
                        datatype: 'JSON',
                        data: JSON.stringify({ "CustomerId": $("#CustomerId").val(), "Col": $("#addContact_Col").val(), "Condition": $("#addContact_Condition").val(), "conditionValue": $("#addContact_conditionValue").val(), Page: Page }),
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            var Maintain = eval(data);
                            for (var i = 0; i < Maintain.length; i++) {
                                $("#divContacttGrid table tbody").append("<tr>" +
                                    "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectContact(this)'>選擇</a>" +
                                    "<td class='ContactIdType'>" + Maintain[i].ContactId + "</td>" +
                                    "<td class='ContactType'>" + Maintain[i].Contact + "</td>" +
                                    "<td class='DepartmentType'>" + Maintain[i].Department + "</td>" +
                                    "<td class='OccupationType'>" + Maintain[i].Occupation + "</td>" +
                                    "<td class='TelNoType'>" + Maintain[i].TelNo + "</td>" +
                                    "<td class='FaxNoType'>" + Maintain[i].FaxNo + "</td>" +
                                    "<td class='EmailType'>" + Maintain[i].Email + "</td>" +
                                    "<td class='RemarkType'>" + Maintain[i].Remark + "</td>" +
                                    "</tr>");
                            }
                        }
                    });
                    $("#ContactPage").val(Page);
                }
            }
        });

        $('#id_SerialNo').blur(function () {
            if (document.getElementById("id_SerialNo").readOnly == true) {
                return;
            }
            if ($("#id_SerialNo").val().trim() != "") {
                $.ajax({
                    url: '@Url.Action("SearchWarrantySerialNoInfo", "Main", new { Area = "SERI06" })',
                    data: JSON.stringify({ "SerialNo": $("#id_SerialNo").val().trim(), "ChangeDate": $("#id_OrderDate").val().trim() }),
                    type: 'POST',
                    contentType: 'application/json; charset=utf-8',
                    success: function (data) {
                        $("#id_ProductNo").val(data.ProductNo);        //品號
                        $("#id_ProductName").val(data.ProductName);        //品號
                        $("#id_SerialNo").val(data.SerialNo);        //品號
                        $("#id_SaleDate").val(data.SalesDate);        //品號
                        $("#id_PurchaseDate").val(data.PurchaseDate);        //品號
                        $("#id_WarrantyStartDate").val(data.WarrantySDate);        //品號
                        $("#id_WarrantyExpiryDate").val(data.WarrantyEDate);        //品號
                        if (data.WarrantySDate < $("#id_OrderDate").val()
                            && $("#id_OrderDate").val() < data.WarrantyEDate)        //續約
                        {
                            document.getElementById('id_UnderWarranty').checked = true;
                        } else {
                            document.getElementById('id_UnderWarranty').checked = false;
                        }
                    },
                    error: function () {
                        $("#msg_information").html("序號不存在！");
                        $('.msg-modal-lg').modal();
                        $("#id_ProductNo").val("");        //品號
                        $("#id_ProductName").val("");        //品號
                        $("#id_SerialNo").val("");        //品號
                        $("#id_SaleDate").val("");        //品號
                        $("#id_PurchaseDate").val("");        //品號
                        $("#id_WarrantyStartDate").val("");        //品號
                        $("#id_WarrantyExpiryDate").val("");        //品號
                        document.getElementById('id_UnderWarranty').checked = false;
                        return;
                    }
                })
            } else {
                $("#id_SerialNo").val("");        //品號
                $("#id_SaleDate").val("");        //品號
                $("#id_PurchaseDate").val("");        //品號
                $("#id_WarrantyStartDate").val("");        //品號
                $("#id_WarrantyExpiryDate").val("");        //品號
            }
        });

        $("#btnSerialNo").click(function () {
            $.ajax({
                url: '@Url.Action("SearchWarrantySerialNo", "Main",new { Area = "SERI06" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "ProductNo": $("#ProductNo").val(), "SerialNo": "", "ChangeDate": $("#id_OrderDate").val(), "WarrantyType": "23", "TargetId": $("#id_CustomerId").val(), Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divWarrantySerialNoGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                            $("#divWarrantySerialNoGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectSerialNo(this)'>選擇</a>" +
                                "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                                "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                                "<td class='SerialNoType'>" + Maintain[i].SerialNo + "</td>" +
                                "<td class='ChangeDateType'>" + Maintain[i].ChangeDate + "</td>" +
                                "<td class='TargetIdType'>" + Maintain[i].TargetId + "</td>" +
                                "<td class='TargetNameType'>" + Maintain[i].TargetName + "</td>" +
                                "<td class='WarrantySDateType'>" + Maintain[i].WarrantySDate + "</td>" +
                                "<td class='WarrantyEDateType'>" + Maintain[i].WarrantyEDate + "</td>" +
                                "<td class='WarrantyTypeType'>" + Maintain[i].WarrantyType + "</td>" +
                                "</tr>");

                    }
                }
            });
            $("#txtWarrantyProductNo").val($("#ProductNo").val());
            $("#txtWarrantySerialNo").val("");
            $("#txtWarrantyTargetId").val($("#id_CustomerId").val());
            $("#WarrantySerialNoPage").val("1");
            $(".record-selector-WarrantySerialNo-modal").modal();
        });

        $("#btnWarrantySerialNo").click(function () {
            $.ajax({
                url: '@Url.Action("SearchWarrantySerialNo", "Main", new { Area = "SERI06" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "ProductNo": $("#txtWarrantyProductNo").val(), "SerialNo": $("#txtWarrantySerialNo").val(), "ChangeDate": $("#id_OrderDate").val(), "WarrantyType": "23", "TargetId": $("#txtWarrantyTargetId").val(), Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divWarrantySerialNoGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divWarrantySerialNoGrid table tbody").append("<tr>" +
                            "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectSerialNo(this)'>選擇</a>" +
                                "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                                "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                                "<td class='SerialNoType'>" + Maintain[i].SerialNo + "</td>" +
                                "<td class='ChangeDateType'>" + Maintain[i].ChangeDate + "</td>" +
                                "<td class='TargetIdType'>" + Maintain[i].TargetId + "</td>" +
                                "<td class='TargetNameType'>" + Maintain[i].TargetName + "</td>" +
                                "<td class='WarrantySDateType'>" + Maintain[i].WarrantySDate + "</td>" +
                                "<td class='WarrantyEDateType'>" + Maintain[i].WarrantyEDate + "</td>" +
                                "<td class='WarrantyTypeType'>" + Maintain[i].WarrantyType + "</td>" +
                                "</tr>");
                    }
                }
            });
            $("#WarrantySerialNoPage").val("1");
        });

        $("#divWarrantySerialNoGrid").scroll(function () {
            var Page = document.getElementById("WarrantySerialNoPage").value;;
            if (Page != 0) {
                var scrollTop = $(this).scrollTop();
                //var scrollHeight = $(document).height();
                //var windowHeight = $(this).height();
                if (scrollTop + 500 >= (870 - 370) * (Page - 1)) {
                    //此处是滚动条到底部时候触发的事件，在这里写要加载的数据，或者是拉动滚动条的操作
                    Page = parseInt(Page) + 1;
                    $.ajax({
                        url: '@Url.Action("SearchWarrantySerialNo", "Main", new { Area = "SERI06" })',
                        type: "POST",
                        datatype: 'JSON',
                        data: JSON.stringify({ "ProductNo": $("#txtWarrantyProductNo").val(), "SerialNo": $("#txtWarrantySerialNo").val(), "ChangeDate": $("#id_OrderDate").val(), "WarrantyType": "23", "TargetId": $("#txtWarrantyTargetId").val(), Page: Page }),
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            var Maintain = eval(data);
                            for (var i = 0; i < Maintain.length; i++) {
                                $("#divWarrantySerialNoGrid table tbody").append("<tr>" +
                                    "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectSerialNo(this)'>選擇</a>" +
                                "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                                "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                                "<td class='SerialNoType'>" + Maintain[i].SerialNo + "</td>" +
                                "<td class='ChangeDateType'>" + Maintain[i].ChangeDate + "</td>" +
                                "<td class='TargetIdType'>" + Maintain[i].TargetId + "</td>" +
                                "<td class='TargetNameType'>" + Maintain[i].TargetName + "</td>" +
                                "<td class='WarrantySDateType'>" + Maintain[i].WarrantySDate + "</td>" +
                                "<td class='WarrantyEDateType'>" + Maintain[i].WarrantyEDate + "</td>" +
                                "<td class='WarrantyTypeType'>" + Maintain[i].WarrantyType + "</td>" +
                                "</tr>");
                            }
                        }
                    });
                    $("#WarrantySerialNoPage").val(Page);
                }
            }
        });


        $('#id_ProductNo').blur(function () {
            if (document.getElementById("id_ProductNo").readOnly == true) {
                return;
            }
            if ($("#id_ProductNo").val().trim() != "") {
                $.ajax({
                    url: '@Url.Action("SearchProductInfo", "Main")',
                    data: JSON.stringify({ "ProductNo": $("#id_ProductNo").val().trim() }),
                    type: 'POST',
                    contentType: 'application/json; charset=utf-8',
                    success: function (data) {
                        $("#id_ProductNo").val(data.ProductNo);        //品號
                        $("#id_ProductName").val(data.ProductName);     //品名
                    },
                    error: function () {
                        $("#msg_information").html("品號不存在！");
                        $('.msg-modal-lg').modal();
                        $("#id_ProductNo").val("");        //品號
                        $("#id_ProductName").val("");     //品名
                    }
                })
            } else {
                $("#id_ProductNo").val("");        //品號
                $("#id_ProductName").val("");     //品名
            }
        });

        $("#btnServiceArrange_D").click(function () {

            if (document.getElementById("id_CustomerId").value == "") {
                $("#msg_information").html("客戶代號不能為空！");
                $('.msg-modal-lg').modal();
                return;
            }

            if (document.getElementById("id_RoutineServiceFreq").value == "") {
                $("#msg_information").html("定期保養不能為空！");
                $('.msg-modal-lg').modal();
                return;
            }

            if (document.getElementById("id_WarrantyPeriod").value == "") {
                $("#msg_information").html("保固期限不能為空！");
                $('.msg-modal-lg').modal();
                return;
            }

            if (document.getElementById("id_WarrantySDate").value == "") {
                $("#msg_information").html("保固起日不能為空！");
                $('.msg-modal-lg').modal();
                return;
            }

            if (document.getElementById("id_WarrantyEDate").value == "") {
                $("#msg_information").html("保固迄日不能為空！");
                $('.msg-modal-lg').modal();
                return;
            }

            var AddressSName = "";
            var Address = "";

            //查找客戶基本信息
            $.ajax({
                url: '@Url.Action("SearchCustomerInfo", "Main", new { Area = "CMSI09" })',
                data: JSON.stringify({ "CustomerId": $("#id_CustomerId").val().trim() }),
                type: 'POST',
                async: false,
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    AddressSName = data.AddressSName;     //地址簡稱
                    Address = data.Address;    //地址
                }
            })

            var avgMonth = parseInt($("#id_WarrantyPeriod").val()) / parseInt($("#id_RoutineServiceFreq").val());

            var Amonth = new Date(document.getElementById("id_WarrantySDate").value);

            for (var i = 0; i < parseInt($("#id_RoutineServiceFreq").val()) ; i++) {
                Amonth.setMonth(Amonth.getMonth() + parseInt(avgMonth));
                var year = Amonth.getFullYear();//当前年份
                var month = Amonth.getMonth() + 1;//当前月份
                if (month.toString().length == 1) {
                    month = "0" + month;
                }
                var arrMonth = year.toString() + month.toString();
                $("#divServiceArrange_DGrid table tbody").append("<tr>" +
                    "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='ProductDExit(this)'>編輯</a>|<a class='btn btn-link' data-dismiss='modal' onclick='RemoveProcess(this)'>刪除</a>" +
                    "<td class='ItemId'>" + addZero((parseInt(i) + 1).toString(), 4) + "<input type='hidden' class='strCItemId' name='strCItemId' value='" + addZero((parseInt(i) + 1).toString(), 4) + "'></td>" +
                    "<td class='ArrangeMonth'>" + arrMonth + "<input type='hidden' class='strCArrangeMonth' name='strCArrangeMonth' value='" + arrMonth + "'></td>" +
                    "<td class='AddressSName'>" + AddressSName + "<input type='hidden' class='strCAddressSName' name='strCAddressSName' value='" + AddressSName + "'></td>" +
                    "<td class='Address'>" + Address + "<input type='hidden' class='strCAddress' name='strCAddress' value='" + Address + "'></td>" +
                    "<td class='IsClosed'> N.未結案<input type='hidden' class='strCIsClosed' name='strCIsClosed' value='N.未結案'></td>" +
                    "<td class='DRemark'>" + $("#id_Remark").val() + "<input type='hidden' class='strCRemark' name='strCRemark' value='" + $("#id_Remark").val() + "'></td>" +
                    "</tr>");
            }

            $('#btnServiceArrange_D').attr('disabled', true);
            $('#btnCleanServiceArrange_D').removeAttr("disabled");
        });

        $("#btnCleanServiceArrange_D").click(function () {
            $("#divServiceArrange_DGrid table tbody").empty();
            $('#btnCleanServiceArrange_D').attr('disabled', true);
            $('#btnServiceArrange_D').removeAttr("disabled");
        });

        $("#btnChooseTargetId").click(function () {
            $('.choose-modal').modal();
        });

        $("#btnRGA_Q").click(function () {
            $.ajax({
                url: '@Url.Action("SearchQuestionList", "Main", new { Area = "SERI03" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "QuestionNo": "", "QuestionTopic": "", Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divQuestionListGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divQuestionListGrid table tbody").append("<tr>" +
                            "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectQuestionList(this)'>選擇</a>" +
                            "<td class='QuestionNoType'>" + Maintain[i].QuestionNo + "</td>" +
                            "<td class='QuestionTopicType'>" + Maintain[i].QuestionTopic + "</td>" +
                            "<td class='QuestionDetailType'>" + Maintain[i].QuestionDetail + "</td>" +
                            "<td><input type='hidden' class='RemarkType' name='version' value='" + Maintain[i].Remark + "'>" + "</td>" +
                            "</tr>");
                    }
                }
            });
            $("#txtQuestionListQuestionNo").val("");
            $("#txtQuestionListQuestionTopic").val("");
            $("#QuestionListPage").val("1");
            $(".record-selector-QuestionList-modal").modal();

        });

        $("#btnQuestionList").click(function () {
            $.ajax({
                url: '@Url.Action("SearchQuestionList", "Main", new { Area = "SERI03" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "QuestionNo": $("#txtQuestionListQuestionNo").val(), "QuestionTopic": $("#txtQuestionListQuestionTopic").val(), Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divQuestionListGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divQuestionListGrid table tbody").append("<tr>" +
                            "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectQuestionList(this)'>選擇</a>" +
                            "<td class='QuestionNoType'>" + Maintain[i].QuestionNo + "</td>" +
                            "<td class='QuestionTopicType'>" + Maintain[i].QuestionTopic + "</td>" +
                            "<td class='QuestionDetailType'>" + Maintain[i].QuestionDetail + "</td>" +
                            "<td><input type='hidden' class='RemarkType' name='version' value='" + Maintain[i].Remark + "'>" + "</td>" +
                            "</tr>");
                    }
                }
            });
            $("#QuestionListPage").val("1");
        });

        $("#divQuestionListGrid").scroll(function () {
            var Page = document.getElementById("QuestionListPage").value;;
            if (Page != 0) {
                var scrollTop = $(this).scrollTop();
                //var scrollHeight = $(document).height();
                //var windowHeight = $(this).height();
                if (scrollTop + 500 >= (870 - 370) * (Page - 1)) {
                    //此处是滚动条到底部时候触发的事件，在这里写要加载的数据，或者是拉动滚动条的操作
                    Page = parseInt(Page) + 1;
                    $.ajax({
                        url: '@Url.Action("SearchQuestionList", "Main", new { Area = "SERI03" })',
                        type: "POST",
                        datatype: 'JSON',
                        data: JSON.stringify({ "QuestionNo": $("#txtQuestionListQuestionNo").val(), "QuestionTopic": $("#txtQuestionListQuestionTopic").val(), Page: Page }),
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            var Maintain = eval(data);
                            for (var i = 0; i < Maintain.length; i++) {
                                $("#divQuestionListGrid table tbody").append("<tr>" +
                                    "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectQuestionList(this)'>選擇</a>" +
                                    "<td class='QuestionNoType'>" + Maintain[i].QuestionNo + "</td>" +
                                    "<td class='QuestionTopicType'>" + Maintain[i].QuestionTopic + "</td>" +
                                    "<td class='QuestionDetailType'>" + Maintain[i].QuestionDetail + "</td>" +
                                    "<td><input type='hidden' class='RemarkType' name='version' value='" + Maintain[i].Remark + "'>" + "</td>" +
                                    "</tr>");
                            }
                        }
                    });
                    $("#QuestionListPage").val(Page);
                }
            }

        });

        $("#btnRGA_D").click(function () {
            if ($("#id_ProductNo").val().length == 0)
            {
                $("#msg_information").html("請先輸入品號！");
                $('.msg-modal-lg').modal();
                return;
            }
            var stritemid = addZero(document.getElementById("divRGA_DGrid").getElementsByTagName('tr').length.toString(), 4);
            $("#id_RGA_DItemNo").val(stritemid);
            $("#id_RGA_DPartNo").val("");
            $("#id_RGA_DPartName").val("");
            $("#id_RGA_DPartQTY").val("0");
            $("#id_RGA_DUnit").val("");
            $("#id_RGA_DRemark").val("");
            $("#id_RGA_DRemark").checked = false;
            $("#id_RGA_DSourceOrderType").val("");
            $("#id_RGA_DSourceOrderNo").val("");
            $("#id_RGA_DSourceItemId").val("");
            $(".RGA_D-modal").modal();
        });

        $("#btnRGA_DPartNo").click(function () {
            $.ajax({
                url: '@Url.Action("SearchBOMD", "Main")',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "MajorComponentNo": $("#id_ProductNo").val(), "Col": "", "Condition": "", "conditionValue": "", Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divBOM_DGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divBOM_DGrid table tbody").append("<tr>" +
                            "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectBOM_D(this)'>選擇</a>" +
                            "<td class='ComponentNoType'>" + Maintain[i].ComponentNo + "</td>" +
                            "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                            "<td class='UnitType'>" + Maintain[i].Unit + "</td>" +
                            "</tr>");
                    }
                }
            });
            $("#addconditionValue").val("");
            $("#BOM_DPage").val("1");
            $(".RGA_D-modal").modal("hide");
            $(".record-selector-BOM_D-modal").modal();

        });

        $("#btnSearchBOM_D").click(function () {
            $.ajax({
                url: '@Url.Action("SearchBOMD", "Main")',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "MajorComponentNo": $("#id_ProductNo").val(), "Col": $("#addBOM_DCol").val(), "Condition": $("#addBOM_DCondition").val(), "conditionValue": $("#addBOM_DconditionValue").val(), Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divBOM_DGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divBOM_DGrid table tbody").append("<tr>" +
                            "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectBOM_D(this)'>選擇</a>" +
                            "<td class='ComponentNoType'>" + Maintain[i].ComponentNo + "</td>" +
                            "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                            "<td class='UnitType'>" + Maintain[i].Unit + "</td>" +
                            "</tr>");
                    }
                }
            });
            $("#BOM_DPage").val("1");
        });

        $("#divBOM_DGrid").scroll(function () {
            var Page = document.getElementById("BOM_DPage").value;;
            if (Page != 0) {
                var scrollTop = $(this).scrollTop();
                //var scrollHeight = $(document).height();
                //var windowHeight = $(this).height();
                if (scrollTop + 500 >= (870 - 370) * (Page - 1)) {
                    //此处是滚动条到底部时候触发的事件，在这里写要加载的数据，或者是拉动滚动条的操作
                    Page = parseInt(Page) + 1;
                    $.ajax({
                        url: '@Url.Action("SearchBOMD", "Main")',
                        type: "POST",
                        datatype: 'JSON',
                        data: JSON.stringify({ "MajorComponentNo": $("#id_ProductNo").val(), "Col": $("#addBOM_DCol").val(), "Condition": $("#addBOM_DCondition").val(), "conditionValue": $("#addBOM_DconditionValue").val(), Page: Page }),
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            var Maintain = eval(data);
                            for (var i = 0; i < Maintain.length; i++) {
                                $("#divBOM_DGrid table tbody").append("<tr>" +
                                    "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectBOM_D(this)'>選擇</a>" +
                                    "<td class='ComponentNoType'>" + Maintain[i].ComponentNo + "</td>" +
                                    "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                                    "<td class='UnitType'>" + Maintain[i].Unit + "</td>" +
                                    "</tr>");
                            }
                        }
                    });
                    $("#BOM_DPage").val(Page);
                }
            }

        });

        $("#btnConfirmedY").click(function () {
            var myDate = new Date();
            var year = myDate.getFullYear();
            var month = myDate.getMonth() + 1;
            var date = myDate.getDate();
            $("#id_sureConfirmDate").val(year + "/" + month + "/" + date);
            $(".sure-modal").modal();
        });

        $("#btnConfirmedV").click(function () {
            $("#choose_msg_information").html("是否確定作廢" + $("#id_RGAType").val() + "-" + $("#id_RGANo").val() + "?");
            $('.choose-msg-modal-lg').modal();
            $(".btnChoose").on("click", function () {
                if ($(this).attr("value") == "True") {
                    $.ajax({
                    url: '@Url.Action("Confirmed", "Main",new { Type ='V'})',
                    data: $('#from-RGA_H').serialize(),
                    type: 'POST',
                    async: false,
                    contentType: 'application/x-www-form-urlencoded',
                    success: function (data) {
                        var strData = data.split('-');
                        if (strData[0] == "NO") {
                            $("#msg_information").html(strData[1]);
                            $('.msg-modal-lg').modal();
                        } else {
                            window.location.href = '@Url.Action("Index", "Main")';
                        }

                    }
                })
                }
            })
        });

        $("#btnCopyOrder").click(function () {
            $.ajax({
                url: '@Url.Action("SearchPhoneService", "Main", new { Area = "SERI05" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "PhoneSerType": "", "PhoneSerNo": "", "CustomerId": $("#id_CustomerId").val(), "Confirmed": "N", Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divPhoneServiceGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divPhoneServiceGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectPhoneService(this)'>選擇</a>" +
                                "<td class='PhoneSerTypeType'>" + Maintain[i].PhoneSerType + "</td>" +
                                "<td class='PhoneSerNoType'>" + Maintain[i].PhoneSerNo + "</td>" +
                                "<td class='CustomerIdType'>" + Maintain[i].CustomerId + "</td>" +
                                "<td class='CustomerNameType'>" + Maintain[i].CustomerName + "</td>" +
                                "<td class='CustomerTypeType'>" + Maintain[i].CustomerType + "</td>" +
                                "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                                "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                                "<td class='SerialNoType'>" + Maintain[i].SerialNo + "</td>" +
                                "<td class=''></td>" +
                                "</tr>");
                    }
                }
            });
            $("#txtPhoneSerType").val("");
            $("#txtPhoneSerNo").val("");
            $("#txtPhoneServiceCustomerId").val($("#id_CustomerId").val());
            $("#PhoneServicePage").val("1");
            $(".record_selector_PhoneService-modal").modal();

        });

        $("#btnSearchPhoneService").click(function () {
            $.ajax({
                url: '@Url.Action("SearchPhoneService", "Main", new { Area = "SERI05" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "PhoneSerType": $("#txtPhoneSerType").val(), "PhoneSerNo": $("#txtPhoneSerNo").val(), "CustomerId": $("#txtPhoneServiceCustomerId").val(), "Confirmed": "N", Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divPhoneServiceGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divPhoneServiceGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectPhoneService(this)'>選擇</a>" +
                                "<td class='PhoneSerTypeType'>" + Maintain[i].PhoneSerType + "</td>" +
                                "<td class='PhoneSerNoType'>" + Maintain[i].PhoneSerNo + "</td>" +
                                "<td class='CustomerIdType'>" + Maintain[i].CustomerId + "</td>" +
                                "<td class='CustomerNameType'>" + Maintain[i].CustomerName + "</td>" +
                                "<td class='CustomerTypeType'>" + Maintain[i].CustomerType + "</td>" +
                                "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                                "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                                "<td class='SerialNoType'>" + Maintain[i].SerialNo + "</td>" +
                                "<td class=''></td>" +
                                "</tr>");
                    }
                }
            });
            $("#PhoneServicePage").val("1");
        });

        $("#divPhoneServiceGrid").scroll(function () {
            var Page = document.getElementById("PhoneServicePage").value;;
            if (Page != 0) {
                var scrollTop = $(this).scrollTop();
                //var scrollHeight = $(document).height();
                //var windowHeight = $(this).height();
                if (scrollTop + 500 >= (870 - 370) * (Page - 1)) {
                    //此处是滚动条到底部时候触发的事件，在这里写要加载的数据，或者是拉动滚动条的操作
                    Page = parseInt(Page) + 1;
                    $.ajax({
                        url: '@Url.Action("SearchPhoneService", "Main", new { Area = "SERI05" })',
                        type: "POST",
                        datatype: 'JSON',
                        data: JSON.stringify({ "PhoneSerType": $("#txtPhoneSerType").val(), "PhoneSerNo": $("#txtPhoneSerNo").val(), "CustomerId": $("#txtPhoneServiceCustomerId").val(), "Confirmed": "N", Page: Page }),
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            var Maintain = eval(data);
                            for (var i = 0; i < Maintain.length; i++) {
                                $("#divPhoneServiceGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectPhoneService(this)'>選擇</a>" +
                                "<td class='PhoneSerTypeType'>" + Maintain[i].PhoneSerType + "</td>" +
                                "<td class='PhoneSerNoType'>" + Maintain[i].PhoneSerNo + "</td>" +
                                "<td class='CustomerIdType'>" + Maintain[i].CustomerId + "</td>" +
                                "<td class='CustomerNameType'>" + Maintain[i].CustomerName + "</td>" +
                                "<td class='CustomerTypeType'>" + Maintain[i].CustomerType + "</td>" +
                                "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                                "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                                "<td class='SerialNoType'>" + Maintain[i].SerialNo + "</td>" +
                                "<td class=''></td>" +
                                "</tr>");
                            }
                        }
                    });
                    $("#PhoneServicePage").val(Page);
                }
            }

        });

    });

    @*function ConfirmedV(id) {
        $("#choose_msg_information").html("是否確定作廢" + $("#id_RGAType").val() + "-" + $("#id_RGANo").val() + "?");
        $('.choose-msg-modal-lg').modal();
        $(".btnChoose").on("click", function () {
            if ($(this).attr("value") == "True") {
                $.ajax({
                    url: '@Url.Action("Delete", "Main",new { Area = "SERI02" })',
                    data: JSON.stringify({ "OrderType": OrderType, "OrderCategory": OrderCategory }),
                    type: 'POST',
                    async: false,
                    contentType: 'application/json; charset=utf-8',
                    success: function (data) {
                        var strData = data.split('-');
                        if (strData[0] == "OK") {
                            $(id).parents('tr:first').remove();
                        } else {
                            OrderType = "";
                            OrderCategory = "";
                            $("#msg_information").html(strData[1]);
                            $('.msg-modal-lg').modal();
                        }
                    }
                })
            }
        })
    }*@

    function ChangeOrder() {
        if ($("#id_WarrantyStartDate").val() < $("#id_OrderDate").val()
            && $("#id_OrderDate").val() < $("#id_WarrantyExpiryDate").val())        //續約
        {
            document.getElementById('id_UnderWarranty').checked = true;
        } else {
            document.getElementById('id_UnderWarranty').checked = false;
        }
    }

    function RemoveQuestionList(id) {
        $(id).parents('tr:first').remove();
    };

    function CountSysc(idname) {
        if (document.getElementById("id_RGAType").value == "") {
            $("#msg_information").html("單別不能為空！");
            $('.msg-modal-lg').modal();
            $('#id_RGANo').val("");
            return;
        }

        var Regx = /^[0-9]*$/;
        if (!Regx.test(document.getElementById(idname).value)) {
            $("#msg_information").html("單號只能包含数字");
            $('.msg-modal-lg').modal();
            $('#id_RGANo').val("");
            return;
        }
        $.ajax({
            url: '@Url.Action("CountSysc", "Main", new { Area = "SUPI05" })',
            data: JSON.stringify({ "CodeType": $("#id_RGAType").val().trim(), "CodeNumber": document.getElementById(idname).value }),
            type: 'POST',
            async: false,
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                var strData = data.split('-');
                if (strData[0] == "NO") {
                    $("#msg_information").html(strData[1]);
                    $('.msg-modal-lg').modal();
                    $('#id_RGANo').val("");
                }
            }
        });
    };

    function SelectProduct(id) {
        $("#id_ProductNo").val($(id).closest('tr').find(".ProductNoType").html());        //品號
        $("#id_ProductName").val($(id).closest('tr').find(".ProductNameType").html());     //品名
    }

    function SelectBOM_D(id) {
        $("#id_RGA_DPartNo").val($(id).closest('tr').find(".ComponentNoType").html());        //品號
        $("#id_RGA_DPartName").val($(id).closest('tr').find(".ProductNameType").html());     //品名
        $("#id_RGA_DUnit").val($(id).closest('tr').find(".UnitType").html());     //品名
        $(".record-selector-BOM_D-modal").modal("hide");
        $(".RGA_D-modal").modal();
    }

    function SelectQuestionList(id) {
        $("#divRGA_QGrid table tbody").append("<tr>" +
           "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='RemoveQuestionList(this)'>刪除</a>" +
           "<td class='strQQuestionNo'>" + $(id).closest('tr').find(".QuestionNoType").html() + "<input type='hidden' class='strQQuestionNo' name='strQQuestionNo' value='" + $(id).closest('tr').find(".QuestionNoType").html() + "'></td>" +
           "<td class='strQQuestion'>" + $(id).closest('tr').find(".QuestionTopicType").html() + "<input type='hidden' class='strQQuestion' name='strQQuestion' value='" + $(id).closest('tr').find(".QuestionTopicType").html() + "'></td>" +
           "<td class='strQDescription'>" + $(id).closest('tr').find(".QuestionDetailType").html() + "<input type='hidden' class='strQDescription' name='strQDescription' value='" + $(id).closest('tr').find(".QuestionDetailType").html() + "'></td>" +
           "</tr>");
    }

    function RGADExit(id) {
        if ($("#id_ProductNo").val().length == 0) {
            $("#msg_information").html("請先輸入品號！");
            $('.msg-modal-lg').modal();
            return;
        }
        $("#id_RGA_DItemNo").val($(id).closest('tr').find(".strDItemId").val());
        $("#id_RGA_DPartNo").val($(id).closest('tr').find(".strDPartNo").val());
        $("#id_RGA_DPartName").val($(id).closest('tr').find(".strDPartName").val());
        $("#id_RGA_DPartQTY").val($(id).closest('tr').find(".strDQTY").val());
        $("#id_RGA_DUnit").val($(id).closest('tr').find(".strDUnit").val());
        $("#id_RGA_DRemark").val($(id).closest('tr').find(".strDRemark").val());
        if($(id).closest('tr').find(".strDRepaired").val()=="Y")
        {
            $("#id_RGA_DRemark").checked = true;
        }else
        {
            $("#id_RGA_DRemark").checked = false;
        }
        
        $("#id_RGA_DSourceOrderType").val($(id).closest('tr').find(".strDSourceOrderType").val());
        $("#id_RGA_DSourceOrderNo").val($(id).closest('tr').find(".strDSourceOrderNo").val());
        $("#id_RGA_DSourceItemId").val($(id).closest('tr').find(".strDSourceItemId").val());
        $(".RGA_D-modal").modal();
    };

    function RemoveRGAD(id) {
        $(id).parents('tr:first').remove();
        var table = document.getElementById("divRGA_DGrid");
        var trs = table.getElementsByTagName('tr');
        var stritem = "";
        for (var i = 1; i < trs.length; i++) {
            stritem = addZero((i).toString(), 4);
            trs[i].cells[1].innerHTML = stritem + "<input type='hidden' class='strDItemId' name='strDItemId' value='" + stritem + "'>";

        }
    };

    function checkRGAD() {

        if (document.getElementById("id_RGA_DPartNo").value == "") {
            $("#msg_information").html("零件品號不能為空！");
            $('.msg-modal-lg').modal();
            return;
        }
        if ($("#id_RGA_DPartQTY").val() == "")
        {
            $("#id_RGA_DPartQTY").val("0")
        }

        var Repaired = "N";
        if ($("#id_RGA_DRepaired").is(':checked') == true)
        {
            Repaired = "Y";
        }

        var table = document.getElementById("divRGA_DGrid");
        var trs = table.getElementsByTagName('tr');
        for (var i = 0; i < trs.length; i++) {
            if ($(trs[i]).closest('tr').find(".strDItemId").val() == $("#id_RGA_DItemNo").val()) {
                trs[i].innerHTML = "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='RGADExit(this)'>編輯</a><a class='btn btn-link' data-dismiss='modal' onclick='RemoveRGAD(this)'>刪除</a>" +
                "<td class='ItemId'>" + $("#id_RGA_DItemNo").val() + "<input type='hidden' class='strDItemId' name='strDItemId' value='" + $("#id_RGA_DItemNo").val() + "'></td>" +
                "<td class='PartNo'>" + $("#id_RGA_DPartNo").val() + "<input type='hidden' class='strDPartNo' name='strDPartNo' value='" + $("#id_RGA_DPartNo").val() + "'></td>" +
                "<td class='PartName'>" + $("#id_RGA_DPartName").val() + "<input type='hidden' class='strDPartName' name='strDPartName' value='" + $("#id_RGA_DPartName").val() + "'></td>" +
                "<td class='QTY'>" + $("#id_RGA_DPartQTY").val() + "<input type='hidden' class='strDQTY' name='strDQTY' value='" + $("#id_RGA_DPartQTY").val() + "'></td>" +
                "<td class='Unit'>" + $("#id_RGA_DUnit").val() + "<input type='hidden' class='strDUnit' name='strDUnit' value='" + $("#id_RGA_DUnit").val() + "'></td>" +
                "<td class='Remark'>" + $("#id_RGA_DRemark").val() + "<input type='hidden' class='strDRemark' name='strDRemark' value='" + $("#id_RGA_DRemark").val() + "'></td>" +
                "<td class='Repaired'>" + Repaired + "<input type='hidden' class='strDRepaired' name='strDRepaired' value='" + Repaired + "'></td>"+
                "<td class='SourceOrderType'>" + $("#id_RGA_DSourceOrderType").val() + "<input type='hidden' class='strDSourceOrderType' name='strDSourceOrderType' value='" + $("#id_RGA_DSourceOrderType").val() + "'></td>"+
                "<td class='SourceOrderNo'>" + $("#id_RGA_DSourceOrderNo").val() + "<input type='hidden' class='strDSourceOrderNo' name='strDSourceOrderNo' value='" + $("#id_RGA_DSourceOrderNo").val() + "'></td>"+
                "<td class='SourceItemId'>" + $("#id_RGA_DSourceItemId").val() + "<input type='hidden' class='strDSourceItemId' name='strDSourceItemId' value='" + $("#id_RGA_DSourceItemId").val() + "'></td>"+
                $(".RGA_D-modal").modal("hide");
                return;
            }

        }

        $("#divRGA_DGrid table tbody").append("<tr>" +
            "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='RGADExit(this)'>編輯</a><a class='btn btn-link' data-dismiss='modal' onclick='RemoveRGAD(this)'>刪除</a>" +
            "<td class='ItemId'>" + $("#id_RGA_DItemNo").val() + "<input type='hidden' class='strDItemId' name='strDItemId' value='" + $("#id_RGA_DItemNo").val() + "'></td>" +
                "<td class='PartNo'>" + $("#id_RGA_DPartNo").val() + "<input type='hidden' class='strDPartNo' name='strDPartNo' value='" + $("#id_RGA_DPartNo").val() + "'></td>" +
                "<td class='PartName'>" + $("#id_RGA_DPartName").val() + "<input type='hidden' class='strDPartName' name='strDPartName' value='" + $("#id_RGA_DPartName").val() + "'></td>" +
                "<td class='QTY'>" + $("#id_RGA_DPartQTY").val() + "<input type='hidden' class='strDQTY' name='strDQTY' value='" + $("#id_RGA_DPartQTY").val() + "'></td>" +
                "<td class='Unit'>" + $("#id_RGA_DUnit").val() + "<input type='hidden' class='strDUnit' name='strDUnit' value='" + $("#id_RGA_DUnit").val() + "'></td>" +
                "<td class='Remark'>" + $("#id_RGA_DRemark").val() + "<input type='hidden' class='strDRemark' name='strDRemark' value='" + $("#id_RGA_DRemark").val() + "'></td>" +
                "<td class='Repaired'>" + Repaired + "<input type='hidden' class='strDRepaired' name='strDRepaired' value='" + Repaired + "'></td>" +
                "<td class='SourceOrderType'>" + $("#id_RGA_DSourceOrderType").val() + "<input type='hidden' class='strDSourceOrderType' name='strDSourceOrderType' value='" + $("#id_RGA_DSourceOrderType").val() + "'></td>"+
                "<td class='SourceOrderNo'>" + $("#id_RGA_DSourceOrderNo").val() + "<input type='hidden' class='strDSourceOrderNo' name='strDSourceOrderNo' value='" + $("#id_RGA_DSourceOrderNo").val() + "'></td>"+
                "<td class='SourceItemId'>" + $("#id_RGA_DSourceItemId").val() + "<input type='hidden' class='strDSourceItemId' name='strDSourceItemId' value='" + $("#id_RGA_DSourceItemId").val() + "'></td>"+
            "</tr>");

        $(".RGA_D-modal").modal("hide");
    };

    function SelectPhoneService(id) {
        $.ajax({
            url: '@Url.Action("SearchPhoneServiceInfo", "Main", new { Area = "SERI05" })',
            data: JSON.stringify({ "PhoneSerType": $(id).closest('tr').find(".PhoneSerTypeType").html(), "PhoneSerNo": $(id).closest('tr').find(".PhoneSerNoType").html() }),
            type: 'POST',
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                $('#id_SourceOrderType').val(data.PhoneSerType);
                $('#id_SourceOrderNo').val(data.PhoneSerNo);
                $('#id_CustomerId').val(data.CustomerId);
                $('#customername').html(data.CustomerName);
                $('#id_CustomerType').val(data.CustomerType);
                $('#id_AddressSName').val(data.AddressSName);
                $('#id_Address').val(data.Address);
                $('#id_Contact').val(data.Contact);
                $('#id_TelNo').val(data.TelNo);
                $('#id_FaxNo').val(data.FaxNo);
                $('#id_ProductNo').val(data.ProductNo);
                $('#id_ContractType').val(data.ContractType);
                $('#id_ContractNo').val(data.ContractNo);
                $('#id_ProductName').val(data.ProductName);
                $('#id_SerialNo').val(data.SerialNo);
                $('#id_SaleDate').val(data.SaleDate);
                $('#id_PurchaseDate').val(data.PurchaseDate);
                $('#id_WarrantyStartDate').val(data.WarrantyStartDate);
                $('#id_WarrantyExpiryDate').val(data.WarrantyExpiryDate);
                if(data.UnderWarranty=="Y")
                {
                    document.getElementById('id_UnderWarranty').checked = true;
                }else
                {
                    document.getElementById('id_UnderWarranty').checked = false;
                }
            },
            error: function () {
                $("#msg_information").html("資料不存在！");
                $('.msg-modal-lg').modal();
                $('#id_SourceOrderType').val("");
                $('#id_SourceOrderNo').val("");
                $('#id_CustomerId').val("");
                $('#customername').html("");
                $('#id_CustomerType').val("");
                $('#id_AddressSName').val("");
                $('#id_Address').val("");
                $('#id_Contact').val("");
                $('#id_TelNo').val("");
                $('#id_FaxNo').val("");
                $('#id_ProductNo').val("");
                $('#id_ContractType').val("");
                $('#id_ContractNo').val("");
                $('#id_ProductName').val("");
                $('#id_SerialNo').val("");
                $('#id_SaleDate').val("");
                $('#id_PurchaseDate').val("");
                $('#id_WarrantyStartDate').val("");
                $('#id_WarrantyExpiryDate').val("");
                document.getElementById('id_UnderWarranty').checked = false;
                return;
            }
        })
    }

    function btnAdd() {
        if (document.getElementById("id_ProductNo").value == "") {
            $("#msg_information").html("品號不能為空！");
            $('.msg-modal-lg').modal();
            return;
        }

        $.ajax({
            url: '@Url.Action("Add", "Main")',
            data: $('#from-RGA_H').serialize(),
            type: 'POST',
            contentType: 'application/x-www-form-urlencoded',
            success: function (data) {
                var strData = data.split('-');
                if (strData[0] == "NO") {
                    $("#msg_information").html(strData[1]);
                    $('.msg-modal-lg').modal();
                } else {
                    window.location.href = '@Url.Action("Index", "Main")';
                }

            }
        })
    };

    function btnAddAgain() {
        if (document.getElementById("id_ProductNo").value == "") {
            $("#msg_information").html("品號不能為空！");
            $('.msg-modal-lg').modal();
            return;
        }
        $.ajax({
            url: '@Url.Action("SerialNo", "Main")',
            data: JSON.stringify({ "SerialNo": document.getElementById("id_SerialNo").value }),
            type: 'POST',
            async: false,
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                if (data == false) {
                    $("#msg_information").html("輸入的商品序號已存在，請重新輸入！");
                    $('.msg-modal-lg').modal();
                    return;
                }
            }
        })

        $.ajax({
            url: '@Url.Action("Add", "Main")',
            data: $('#from-RGA_H').serialize(),
            type: 'POST',
            contentType: 'application/x-www-form-urlencoded',
            success: function (data) {
                var strData = data.split('-');
                if (strData[0] == "NO") {
                    $("#msg_information").html(strData[1]);
                    $('.msg-modal-lg').modal();
                } else {
                    window.location.href = '@Url.Action("CUR", "Main")';
                }

            }
        })
    };

    function btnExit() {
        $.ajax({
            url: '@Url.Action("Exit", "Main")',
            data: $('#from-RGA_H').serialize(),
            type: 'POST',
            contentType: 'application/x-www-form-urlencoded',
            success: function (data) {
                var strData = data.split('-');
                if (strData[0] == "NO") {
                    $("#msg_information").html(strData[1]);
                    $('.msg-modal-lg').modal();
                } else {
                    window.location.href = '@Url.Action("Index", "Main")';
                }

            }
        })
    };

    function btnExitAgain() {
        $.ajax({
            url: '@Url.Action("Exit", "Main")',
            data: $('#from-RGA_H').serialize(),
            type: 'POST',
            contentType: 'application/x-www-form-urlencoded',
            success: function (data) {
                var strData = data.split('-');
                if (strData[0] == "NO") {
                    $("#msg_information").html(strData[1]);
                    $('.msg-modal-lg').modal();
                } else {
                    window.location.href = '@Url.Action("CUR", "Main")';
                }

            }
        })
    };

    function check() {
        if ($("#id_Warranty_DChangeDate").val() == '') {
            $("#msg_information").html("異動日期不能為空！");
            $('.msg-modal-lg').modal();
            return;
        }

        if ($("#id_Warranty_DTargetId").val() == '') {
            $("#msg_information").html("異動對象不能為空！");
            $('.msg-modal-lg').modal();
            return;
        }

        if ($("#id_Warranty_DWarrantyPeriod").val() == '') {
            $("#msg_information").html("保固期限不能為空！");
            $('.msg-modal-lg').modal();
            return;
        }
        if (parseInt($("#id_Warranty_DWarrantyPeriod").val()) == 0) {
            $("#msg_information").html("保固期限須大於0！");
            $('.msg-modal-lg').modal();
            return;
        }
        if ($("#id_Warranty_DWarrantySDate").val() == '') {
            $("#msg_information").html("请输入保固起日！");
            $('.msg-modal-lg').modal();
            return;
        }

        if ($("#id_Warranty_DWarrantyEDate").val() == '') {
            $("#msg_information").html("请输入保固迄日！");
            $('.msg-modal-lg').modal();
            return;
        }

        $("#divServiceArrange_DGrid table tbody").append("<tr>" +
            "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='ProductDExit(this)'>編輯</a>|<a class='btn btn-link' data-dismiss='modal' onclick='RemoveProcess(this)'>刪除</a>" +
            "<td class='ChangeDate'>" + $("#id_Warranty_DChangeDate").val() + "<input type='hidden' class='strCChangeDate' name='strCChangeDate' value='" + $("#id_Warranty_DChangeDate").val() + "'></td>" +
            "<td class='ChangeOrderType'>" + $("#id_Warranty_DChangeOrderType").val() + "<input type='hidden' class='strCChangeOrderType' name='strCChangeOrderType' value='" + $("#id_Warranty_DChangeOrderType").val() + "'></td>" +
            "<td class='ChangeOrderNo'>" + $("#id_Warranty_DChangeOrderNo").val() + "<input type='hidden' class='strCChangeOrderNo' name='strCChangeOrderNo' value='" + $("#id_Warranty_DChangeOrderNo").val() + "'></td>" +
            "<td class='ChangeOrderItemId'>" + $("#id_Warranty_DChangeOrderItemId").val() + "<input type='hidden' class='strCChangeOrderItemId' name='strCChangeOrderItemId' value='" + $("#id_Warranty_DChangeOrderItemId").val() + "'></td>" +
            "<td class='TargetId'>" + $("#id_Warranty_DTargetId").val() + "<input type='hidden' class='strCTargetId' name='strCTargetId' value='" + $("#id_Warranty_DTargetId").val() + "'></td>" +
            "<td class='TargetName'>" + $("#id_Warranty_DTargetName").val() + "<input type='hidden' class='strCTargetName' name='strCTargetName' value='" + $("#id_Warranty_DTargetName").val() + "'></td>" +
            "<td class='WarrantyPeriod'>" + $("#id_Warranty_DWarrantyPeriod").val() + "<input type='hidden' class='strCWarrantyPeriod' name='strCWarrantyPeriod' value='" + $("#id_Warranty_DWarrantyPeriod").val() + "'></td>" +
            "<td class='WarrantySDate'>" + $("#id_Warranty_DWarrantySDate").val() + "<input type='hidden' class='strCWarrantySDate' name='strCWarrantySDate' value='" + $("#id_Warranty_DWarrantySDate").val() + "'></td>" +
            "<td class='WarrantyEDate'>" + $("#id_Warranty_DWarrantyEDate").val() + "<input type='hidden' class='strCWarrantyEDate' name='strCWarrantyEDate' value='" + $("#id_Warranty_DWarrantyEDate").val() + "'></td>" +
            "<td class='WarrantyType'>" + $("#id_Warranty_DWarrantyType").val() + "<input type='hidden' class='strCWarrantyType' name='strCWarrantyType' value='" + $("#id_Warranty_DWarrantyType").val() + "'></td>" +
            "<td class='remark'>" + $("#id_Warranty_DRemark").val() + "<input type='hidden' class='strCRemark' name='strCRemark' value='" + $("#id_Warranty_DRemark").val() + "'></td>" +
            "</tr>");

        $(".Warranty_D-modal").modal("hide");
    };

    function SelectCustomer(id) {
        $("#id_CustomerId").val($(id).closest('tr').find(".CustomerIdType").html());        //客戶代號
        $("#customername").html($(id).closest('tr').find(".CustomerNameType").html());     //客戶名稱
        $("#id_CustomerType").val($(id).closest('tr').find(".CustomerTypeType").html());     //客戶形態
        $("#id_Contact").val($(id).closest('tr').find(".ContactType").html());   //連絡人ID
        $("#id_TelNo").val($(id).closest('tr').find(".TelNoType").html());              //電話
        $("#id_FaxNo").val($(id).closest('tr').find(".FaxNoType").val());    //傳真
        $("#id_AddressSName").val("");    //地址簡稱
        $("#id_Address").val("");    //地址
    };
    //function SelectCustomer(id) {
    //    $("#id_CustomerId").val($(id).closest('tr').find(".CustomerIdType").html());        //客戶代號
    //    $("#customername").html($(id).closest('tr').find(".CustomerNameType").html());     //客戶名稱
    //    $("#id_CustomerType").val($(id).closest('tr').find(".CustomerTypeType").html());     //客戶形態
    //    $("#id_Contact").val($(id).closest('tr').find(".ContactIDType").val());   //連絡人ID
    //    $("#id_ContactName").html($(id).closest('tr').find(".ContactType").html());    //連絡人
    //    $("#id_TelNo").val($(id).closest('tr').find(".TelNoType").html());              //電話
    //    $("#id_FaxNo").val($(id).closest('tr').find(".FaxNoType").html());    //傳真
    //    $("#id_AddressSName").val($(id).closest('tr').find(".AddressSNameType").html());    //地址簡稱
    //    $("#id_Address").val($(id).closest('tr').find(".AddressType").html());    //地址
    //    $("#id_SourceOrderType").val("");      //來源單別
    //    $("#id_SourceOrderNo").val("");    //來源單號
    //    $("#id_SourceOrderItemId").val("");    //來源項次
    //    $("#id_SerialNo").val("");      //序號
    //    $("#id_ProductNo").val("");    //品號
    //    $("#id_ProductName").val("");    //品名
    //    $("#id_WarrantySDate").val("");    //保固起日
    //    $("#id_WarrantyEDate").val("");    //保固迄日
    //};

    function SelectAddress(id) {
        $("#id_AddressSName").val($(id).closest('tr').find(".Address1Type").html());
        $("#id_Address").val($(id).closest('tr').find(".Address2Type").html());
        $('#id_Contact').val($(id).closest('tr').find(".ContactType").html());
        $('#id_TelNo').val($(id).closest('tr').find(".TelNoType").html());
        $('#id_FaxNo').val($(id).closest('tr').find(".FaxNoType").html());
    }

    function SelectContact(id) {
        $("#id_Contact").val($(id).closest('tr').find(".ContactType").html());   //連絡人ID
        //$("#id_ContactName").html($(id).closest('tr').find(".ContactType").html());    //連絡人
        $("#id_TelNo").val($(id).closest('tr').find(".TelNoType").html());              //電話
        $("#id_FaxNo").val($(id).closest('tr').find(".FaxNoType").html());    //傳真
    }

    function SelectVendor(id) {
        $("#id_Warranty_DTargetId").val($(id).closest('tr').find(".vendorIdType").html());      //廠商代號
        $("#id_Warranty_DTargetName").val($(id).closest('tr').find(".vendorNameType").html());    //廠商簡稱
        $('.choose-modal').modal("hide");
    }

    function SelectContractType(id) {
        $("#id_SourceOrderType").val($(id).closest('tr').find(".ContractTypeType").html());      //來源單別
        $("#id_SourceOrderNo").val($(id).closest('tr').find(".ContractNoType").html());    //來源單號
        $("#id_SourceOrderItemId").val("");    //來源項次
        $("#id_CustomerId").val($(id).closest('tr').find(".CustomerIdType").html());        //客戶代號
        $("#customername").html($(id).closest('tr').find(".CustomerNameType").html());     //客戶名稱
        $("#id_CustomerType").val($(id).closest('tr').find(".CustomerTypeType").html());     //客戶形態
        $('.record-selector-Contract-modal').modal("hide");
    }

    function SelectSerialNo(id) {
        $("#id_ProductNo").val($(id).closest('tr').find(".ProductNoType").html());        //品號
        $("#id_ProductName").val($(id).closest('tr').find(".ProductNameType").html());     //品名
        $("#id_SerialNo").val($(id).closest('tr').find(".SerialNoType").html());        //品號
        $("#id_SaleDate").val($(id).closest('tr').find(".SalesDateType").html());     //品名
        $("#id_PurchaseDate").val($(id).closest('tr').find(".PurchaseDateType").html());        //品號
        $("#id_WarrantyStartDate").val($(id).closest('tr').find(".WarrantySDateType").html());     //品名
        $("#id_WarrantyExpiryDate").val($(id).closest('tr').find(".WarrantyEDateType").html());     //品名
        if ($(id).closest('tr').find(".WarrantySDateType").html() < $("#id_OrderDate").val()
            && $("#id_OrderDate").val() < $(id).closest('tr').find(".WarrantyEDateType").html())        //續約
        {
            document.getElementById('id_UnderWarranty').checked = true;
        } else {
            document.getElementById('id_UnderWarranty').checked = false;
        }
    }

    function SelectProductSerialNo(id) {
        $("#id_SourceOrderItemId").val($(id).closest('tr').find(".ItemIdType").html());    //來源項次
        $("#id_SerialNo").val($(id).closest('tr').find(".SerialNoType").html());      //序號
        $("#id_ProductNo").val($(id).closest('tr').find(".ProductNoType").html());    //品號
        $("#id_ProductName").val($(id).closest('tr').find(".ProductNameType").html());    //品名
        $("#id_RoutineServiceFreq").val($(id).closest('tr').find(".RoutineServiceFreqType").html());    //定期保養
        $("#id_WarrantyPeriod").val($(id).closest('tr').find(".WarrantyPeriodType").html());    //保固期限
        $("#id_WarrantySDate").val($(id).closest('tr').find(".WarrantySDateType").html());    //保固起日
        $("#id_WarrantyEDate").val($(id).closest('tr').find(".WarrantyEDateType").html());    //保固迄日
        $('.record-selector-ProductSerial-modal').modal("hide");
    }

    function SelectOrderType(id) {
        $("#id_RGAType").val($(id).closest('tr').find(".OrderTypeType").html());
        $("#ordersname").html($(id).closest('tr').find(".OrderSNameType").html());
        var Edate = new Date($("#id_OrderDate").val());
        Edate.setDate(Edate.getDate() + parseInt($(id).closest('tr').find(".DaysAfterCreateType").val()));
        var year = Edate.getFullYear();//当前年份
        var month = Edate.getMonth() + 1;//当前月份
        var day = Edate.getDate();//当前日
        if (month.toString().length == 1) {
            month = "0" + month;
        }
        if (day.toString().length == 1) {
            day = "0" + day;
        }
        $("#id_PCompletionDate").val(year + "/" + month + "/" + day);
        $.ajax({
            url: '@Url.Action("GetOrderTypeNo", "Main", new { Area = "SUPI05" })',
            data: JSON.stringify({ "OrderType": $("#id_RGAType").val().trim() }),
            type: 'POST',
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                var strData = data.split('-');
                if (strData[0] == "YES") {
                    $('#id_RGANo').val(strData[1]);
                    document.getElementById("id_RGANo").readOnly = "readonly";
                } else if (strData[0] == "NO") {
                    $('#id_RGANo').val(strData[1]);
                    document.getElementById("id_RGANo").readOnly = "";
                } else {
                    $("#msg_information").html(strData[1]);
                    $('.msg-modal-lg').modal();
                    $('#id_RGANo').val("");
                    document.getElementById("id_RGANo").readOnly = "";
                }
            }
        })
    };
</script>
<section class="content-header">
    <h1>維修單維護</h1>
</section>
<section class="content">
    <div class="panel panel-default">
        <div class="panel-heading"><i class="fa fa-pencil fa-fw"></i> Application</div>
        <div class="panel-body">
            <form id="from-RGA_H" method="post">
                <div class="row">
                    <div class="form-group">
                        <label for="id_RGAType" class="col-md-3 col-lg-3 control-label">維修單別</label>
                        <div class="col-md-5 col-lg-5">
                            @if (@ViewBag.Type == "Edit" || @ViewBag.Type == "Details")
                            {
                                <div class="input-group">
                                    <input type="text" class="form-control" id="id_RGAType" name="RGAType" value="@ViewBag.RGAType" readonly />
                                    <span class="input-group-addon" style="cursor:pointer;"><span class="fa fa-hand-pointer-o"></span></span>
                                </div>
                            }
                            else
                            {
                                <div class="input-group">
                                    <input type="text" class="form-control" id="id_RGAType" name="RGAType" value="@ViewBag.RGAType" />
                                    <span class="input-group-addon" id="btnRGAType" style="cursor:pointer;"><span class="fa fa-hand-pointer-o"></span></span>
                                </div>
                            }
                            <span style="display:inline;" id="ordersname">@ViewBag.OrderSName</span>
                        </div>
                        <label for="id_OrderDate" class="col-md-3 col-lg-3 control-label">單據日期</label>
                        @if (ViewBag.Type == "Details")
                        {
                            <div class="col-md-5 col-lg-5 date" data-date="" data-date-format="yyyy/mm/dd" data-link-field="id_OrderDate" data-link-format="yyyy/mm/dd">
                                <div class="input-group">
                                    <input type="text" class="form-control" name="OrderDate" readonly="readonly" value="@ViewBag.OrderDate" />
                                    <span class="input-group-addon" style="cursor:pointer;"><span class="glyphicon glyphicon-calendar"></span></span>
                                </div>
                            </div>
                        }
                        else
                        {
                            <div class="col-md-5 col-lg-5 date" data-date="" data-date-format="yyyy/mm/dd" data-link-field="id_OrderDate" data-link-format="yyyy/mm/dd">
                                <div class="input-group">
                                    <input type="text" class="form-control" id="id_OrderDate" name="OrderDate" readonly="readonly" value="@ViewBag.OrderDate" onchange="ChangeOrder()" />
                                    <span class="input-group-addon" id="basic-addon2" style="cursor:pointer;"><span class="glyphicon glyphicon-calendar"></span></span>
                                </div>
                            </div>
                        }
                        <label for="id_StatusCode" class="col-md-3 col-lg-3 control-label">狀態碼</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="id_StatusCode" name="StatusCode" value="@ViewBag.StatusCode" readonly />
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label for="id_RGANo" class="col-md-3 col-lg-3 control-label">維修單號</label>
                        <div class="col-md-5 col-lg-5">
                            @if (@ViewBag.Type == "Edit" || ViewBag.Type == "Details")
                            {
                                <input type="text" class="form-control" id="id_RGANo" name="RGANo" value="@ViewBag.RGANo" readonly />
                            }
                            else
                            {
                                <input type="text" class="form-control" id="id_RGANo" name="RGANo" value="@ViewBag.RGANo" onchange="CountSysc(this.id)" />
                            }
                        </div>

                        <label for="id_NoOfPrints" class="col-md-3 col-lg-3 control-label">列印次數</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="id_NoOfPrints" name="NoOfPrints" value="@ViewBag.NoOfPrints" readonly />
                        </div>
                        <label for="id_Creator" class="col-md-3 col-lg-3 control-label">建立人員</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="id_Creator" name="Creator" value="@ViewBag.Creator" readonly />
                            <span style="display:inline;" id="CreatorName">@ViewBag.CreatorName</span>
                        </div>

                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label for="id_SourceOrderType" class="col-md-3 col-lg-3 control-label">來源單號</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="id_SourceOrderType" name="SourceOrderType" style="width: 40%; display: inline;" value="@ViewBag.SourceOrderType" readonly />
                            <input type="text" class="form-control" id="id_SourceOrderNo" name="SourceOrderNo" style="width: 55%; display: inline;" value="@ViewBag.SourceOrderNo" readonly />
                        </div>

                        <label for="id_Version" class="col-md-3 col-lg-3 control-label">版次</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="id_Version" name="Version" value="@ViewBag.Version" readonly />
                        </div>
                        <label for="id_Repairman" class="col-md-3 col-lg-3 control-label">維修人員</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="id_Repairman" name="Repairman" value="@ViewBag.Repairman" readonly />
                            <span style="display:inline;" id="CreatorName">@ViewBag.RepairmanName</span>
                        </div>

                    </div>
                </div>
                
                <h5>客戶資訊</h5>
                <hr />
                <div class="row">
                    <div class="form-group">
                        <label for="id_CustomerId" class="col-md-3 col-lg-3 control-label">客戶代號</label>
                        <div class="col-md-5 col-lg-5">
                            @if (@ViewBag.Type == "Edit" || @ViewBag.Type == "Details")
                            {
                                <div class="input-group">
                                    <input type="text" class="form-control" id="id_CustomerId" name="CustomerId" value="@ViewBag.CustomerId" readonly />
                                    <span class="input-group-addon" style="cursor:pointer;"><span class="fa fa-hand-pointer-o"></span></span>
                                </div>
                            }
                            else
                            {
                                 <div class="input-group">
                                    <input type="text" class="form-control" id="id_CustomerId" name="CustomerId" value="@ViewBag.CustomerId" />
                                    <span class="input-group-addon" id="btnCustomerId" style="cursor:pointer;"><span class="fa fa-hand-pointer-o"></span></span>
                                </div>
                            }
                            <span style="display:inline;" id="customername">@ViewBag.CustomerName</span>
                        </div>

                        <label for="id_CustomerType" class="col-md-3 col-lg-3 control-label">客戶形態</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="id_CustomerType" name="CustomerType" value="@ViewBag.CustomerType" readonly />
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label for="id_AddressSName" class="col-md-3 col-lg-3 control-label">地址簡稱</label>
                        <div class="col-md-13 col-lg-13">
                            @if (ViewBag.Type == "Details")
                            {
                                <div class="input-group">
                                    <input type="text" class="form-control" id="id_AddressSName" name="AddressSName" value="@ViewBag.AddressSName" readonly />
                                    <span class="input-group-addon" style="cursor:pointer;"><span class="fa fa-hand-pointer-o"></span></span>
                                </div>
                            }
                            else
                            {
                                <div class="input-group">
                                    <input type="text" class="form-control" id="id_AddressSName" name="AddressSName" value="@ViewBag.AddressSName" />
                                    <span class="input-group-addon" id="btnAddressSName" style="cursor:pointer;"><span class="fa fa-hand-pointer-o"></span></span>
                                </div>
                            }
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label for="id_Address" class="col-md-3 col-lg-3 control-label">地址</label>
                        <div class="col-md-13 col-lg-13">
                            @if (ViewBag.Type == "Details")
                            {
                                <input type="text" class="form-control" id="id_Address" name="Address" value="@ViewBag.Address" readonly />
                            }
                            else
                            {
                                <input type="text" class="form-control" id="id_Address" name="Address" value="@ViewBag.Address" />
                            }
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label for="id_Contact" class="col-md-3 col-lg-3 control-label">聯絡人</label>
                        <div class="col-md-5 col-lg-5">
                            @if (ViewBag.Type == "Details")
                            {
                                <div class="input-group">
                                    <input type="text" class="form-control" id="id_Contact" name="Contact" value="@ViewBag.Contact" readonly />
                                    <span class="input-group-addon" style="cursor:pointer;"><span class="fa fa-hand-pointer-o"></span></span>
                                </div>
                            }
                            else
                            {
                                <div class="input-group">
                                    <input type="text" class="form-control" id="id_Contact" name="Contact" value="@ViewBag.Contact" />
                                    <span class="input-group-addon" id="btnContact" style="cursor:pointer;"><span class="fa fa-hand-pointer-o"></span></span>
                                </div>
                            }
                        </div>
                        <label for="id_TelNo" class="col-md-3 col-lg-3 control-label">電話</label>
                        <div class="col-md-5 col-lg-5">
                            @if (ViewBag.Type == "Details")
                            {
                                <input type="text" class="form-control" id="id_TelNo" name="TelNo" value="@ViewBag.TelNo" readonly />
                            }
                            else
                            {
                                <input type="text" class="form-control" id="id_TelNo" name="TelNo" value="@ViewBag.TelNo" />
                            }
                        </div>
                        <label for="id_FaxNo" class="col-md-3 col-lg-3 control-label">傳真</label>
                        <div class="col-md-5 col-lg-5">
                            @if (ViewBag.Type == "Details")
                            {
                                <input type="text" class="form-control" id="id_FaxNo" name="FaxNo" value="@ViewBag.FaxNo" readonly />
                            }
                            else
                            {
                                <input type="text" class="form-control" id="id_FaxNo" name="FaxNo" value="@ViewBag.FaxNo" />
                            }
                        </div>
                    </div>
                </div>

                <h5>定保資訊</h5>
                <hr />
                <div class="row">
                    <div class="form-group">
                        <label for="id_ProductNo" class="col-md-3 col-lg-3 control-label">品號</label>
                        <div class="col-md-5 col-lg-5">
                            @if (@ViewBag.Type == "Edit" || @ViewBag.Type == "Details")
                            {
                                <div class="input-group">
                                    <input type="text" class="form-control" id="id_ProductNo" name="ProductNo" value="@ViewBag.ProductNo" readonly />
                                    <span class="input-group-addon" style="cursor:pointer;"><span class="fa fa-hand-pointer-o"></span></span>
                                </div>  
                            }
                            else
                            {
                                <div class="input-group">
                                    <input type="text" class="form-control" id="id_ProductNo" name="ProductNo" value="@ViewBag.ProductNo" />
                                    <span class="input-group-addon" id="btnProductNo" style="cursor:pointer;"><span class="fa fa-hand-pointer-o"></span></span>
                                </div>
                            }

                        </div>
                        <label for="id_AssetNo" class="col-md-3 col-lg-3 control-label">資產編號</label>
                        <div class="col-md-5 col-lg-5">
                            @if (ViewBag.Type == "Details")
                            {
                                <input type="text" class="form-control" id="id_AssetNo" name="AssetNo" value="@ViewBag.AssetNo" readonly />
                            }
                            else
                            {
                                <input type="text" class="form-control" id="id_AssetNo" name="AssetNo" value="@ViewBag.AssetNo" />
                            }
                        </div>
                        <label for="id_ContractType" class="col-md-3 col-lg-3 control-label">合約單號</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="id_ContractType" name="ContractType" value="@ViewBag.ContractType" readonly />
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label for="id_ProductName" class="col-md-3 col-lg-3 control-label">品名</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="id_ProductName" name="ProductName" value="@ViewBag.ProductName" readonly />
                        </div>
                        <label for="id_SerialNo" class="col-md-3 col-lg-3 control-label">序號</label>
                        <div class="col-md-5 col-lg-5">
                            @if (@ViewBag.Type == "Edit" || @ViewBag.Type == "Details")
                            {
                                <div class="input-group">
                                    <input type="text" class="form-control" id="id_SerialNo" name="SerialNo" value="@ViewBag.SerialNo" readonly />
                                    <span class="input-group-addon" style="cursor:pointer;"><span class="fa fa-hand-pointer-o"></span></span>
                                </div>
                                
                            }
                            else
                            {
                                <div class="input-group">
                                    <input type="text" class="form-control" id="id_SerialNo" name="SerialNo" value="@ViewBag.SerialNo" />
                                    <span class="input-group-addon" id="btnSerialNo" style="cursor:pointer;"><span class="fa fa-hand-pointer-o"></span></span>
                                </div>
                            }
                        </div>
                        <label for="id_ProductName" class="col-md-3 col-lg-3 control-label">保固內</label>
                        @if (@ViewBag.UnderWarranty == "Y")
                        {
                            <input type="checkbox" id="id_UnderWarranty" name="UnderWarranty" checked disabled />
                        }
                        else
                        {
                            <input type="checkbox" id="id_UnderWarranty" name="UnderWarranty" disabled />
                        }
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label for="id_SaleDate" class="col-md-3 col-lg-3 control-label">銷貨日期</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="id_SaleDate" name="SaleDate" readonly="readonly" value="@ViewBag.SaleDate" />
                        </div>
                        <label for="id_WarrantySDate" class="col-md-3 col-lg-3 control-label">保固起日</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="id_WarrantyStartDate" name="WarrantyStartDate" readonly="readonly" value="@ViewBag.WarrantyStartDate" />
                        </div>
                        <label for="id_WarrantyEDate" class="col-md-3 col-lg-3 control-label">保固迄日</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="id_WarrantyExpiryDate" name="WarrantyExpiryDate" readonly="readonly" value="@ViewBag.WarrantyExpiryDate" />
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label for="id_WarrantyStartDate" class="col-md-3 col-lg-3 control-label">進貨日期</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="id_PurchaseDate" name="PurchaseDate" readonly="readonly" value="@ViewBag.PurchaseDate" />
                        </div>
                        <label for="id_PCompletionDate" class="col-md-3 col-lg-3 control-label">預計完修日</label>
                        @if (ViewBag.Type == "Details")
                        {
                            <div class="col-md-5 col-lg-5 date" data-date="" data-date-format="yyyy/mm/dd" data-link-field="id_OrderDate" data-link-format="yyyy/mm/dd">
                                <div class="input-group">
                                    <input type="text" class="form-control" name="PCompletionDate" readonly="readonly" value="@ViewBag.PCompletionDate" />
                                    <span class="input-group-addon" id="basic-addon2"><span class="glyphicon glyphicon-calendar"></span></span>
                                </div>
                            </div>
                        }
                        else
                        {
                            <div class="col-md-5 col-lg-5 date" data-date="" data-date-format="yyyy/mm/dd" data-link-field="id_OrderDate" data-link-format="yyyy/mm/dd">
                                <div class="input-group">
                                    <input type="text" class="form-control" id="id_PCompletionDate" name="PCompletionDate" readonly="readonly" value="@ViewBag.PCompletionDate" />
                                    <span class="input-group-addon" id="basic-addon2"><span class="glyphicon glyphicon-calendar"></span></span>
                                </div>
                            </div>
                        }
                        <label for="id_CompletionDate" class="col-md-3 col-lg-3 control-label">實際完修日</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="id_CompletionDate" name="CompletionDate" readonly="readonly" value="@ViewBag.CompletionDate" />
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label for="id_OptionDetail" class="col-md-3 col-lg-3 control-label">配件說明</label>
                        <div class="col-md-5 col-lg-5">
                            @if (@ViewBag.Type == "Details")
                            {
                                <input type="text" class="form-control" id="id_OptionDetail" name="OptionDetail" value="@ViewBag.OptionDetail" readonly />
                            }
                            else
                            {
                                <input type="text" class="form-control" id="id_OptionDetail" name="OptionDetail" value="@ViewBag.OptionDetail" />
                            }
                        </div>
                        <label for="id_Returned" class="col-md-3 col-lg-3 control-label">覆修</label>
                        @if (@ViewBag.Type == "Details")
                        {
                            if (@ViewBag.Returned == "Y")
                            {
                                <input type="checkbox" id="id_Returned" name="Returned" checked disabled />
                            }
                            else
                            {
                                <input type="checkbox" id="id_Returned" name="Returned" disabled />
                            }

                        }
                        else
                        {
                            if (@ViewBag.Returned == "Y")
                            {
                                <input type="checkbox" id="id_Returned" name="Returned" checked />
                            }
                            else
                            {
                                <input type="checkbox" id="id_Returned" name="Returned" />
                            }
                        }

                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label for="id_Remark" class="col-md-3 col-lg-3 control-label">入件說明</label>
                        <div class="col-md-13 col-lg-13">
                            @if (@ViewBag.Type == "Details")
                            {
                                <textarea class="form-control" id="id_Remark" name="Remark" cols="40" rows="5" maxlength="255" readonly>@ViewBag.Remark</textarea>
                            }
                            else
                            {
                                <textarea class="form-control" id="id_Remark" name="Remark" cols="40" rows="5" maxlength="255">@ViewBag.Remark</textarea>
                            }
                        </div>
                        <label for="id_Remark" class="col-md-3 col-lg-3 control-label">故障因素</label>
                        @if (@ViewBag.Type == "Details")
                        {
                            <select class="form-control" style="width: 200px;display:inline;" name="MalfunctionReason" disabled>
                                @if (ViewBag.MalfunctionReason == "N")
                                {
                                    <option value="N" selected>N.非人為</option>
                                }
                                else
                                {
                                    <option value="N">N.非人為</option>
                                }
                                @if (ViewBag.MalfunctionReason == "Y")
                                {
                                    <option value="Y" selected>Y.人為</option>
                                }
                                else
                                {
                                    <option value="Y">Y.人為</option>
                                }
                            </select>
                        }
                        else
                        {
                            <select class="form-control" style="width: 200px;display:inline;" name="MalfunctionReason">
                                @if (ViewBag.MalfunctionReason == "N")
                                {
                                    <option value="N" selected>N.非人為</option>
                                }
                                else
                                {
                                    <option value="N">N.非人為</option>
                                }
                                @if (ViewBag.MalfunctionReason == "Y")
                                {
                                    <option value="Y" selected>Y.人為</option>
                                }
                                else
                                {
                                    <option value="Y">Y.人為</option>
                                }
                            </select>
                        }
                    </div>
                </div>
                <ul class="nav nav-tabs" role="tablist">
                    <li class="active"><a href="#tab-issues" data-toggle="tab">問題描述</a></li>
                    <li><a href="#tab-check-content" data-toggle="tab">檢測內容</a></li>
                    <li><a href="#tab-fix-content" data-toggle="tab">維修內容</a></li>
                </ul>
                <div id="TabContent" class="tab-content">
                    <div class="tab-pane in active" id="tab-issues">
                        <div class="text-right">
                            @if (@ViewBag.Type == "Details")
                            {
                                <button type="button" class="btn btn-primary" id="btnRGA_Q" name="action" value="btnRGA_Q" aria-label="Left Align" disabled>
                                    <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 新增問題
                                </button>
                            }
                            else
                            {
                                <button type="button" class="btn btn-primary" id="btnRGA_Q" name="action" value="btnRGA_Q" aria-label="Left Align" tabindex="17">
                                    <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 新增問題
                                </button>
                            }
                        </div>
                        <div id="divRGA_QGrid" style="height: 100px;overflow-y: auto;">
                            @{
                                var webGrid = new WebGrid(source: (IEnumerable<BusinessLayer.Models.RGA_Q>)ViewData["RGA_Q"], canPage: false, canSort: false, ajaxUpdateContainerId: "divRGA_QGrid");
                            }
                            @webGrid.GetHtml(

                            tableStyle: "table table-striped table-hover",
                            columns: webGrid.Columns(
                                webGrid.Column(columnName: "", header: "動作", style: "actioncolumn",
                                    format:
                                    @<text>
                                        @if (@ViewBag.Type == "Details")
                                        {
                                            <a class='btn btn-link'>刪除</a>
                                        }
                                        else
                                        {
                                            <a class='btn btn-link' data-dismiss='modal' onclick='RemoveQuestionList(this)'>刪除</a>
                                        }
                                    </text>),
                                    webGrid.Column(columnName: "strQQuestionNo", header: "問題代號", style: "strQQuestionNo",
                                    format:
                                    @<text>
                                        @item.QuestionNo
                                        <input type="hidden" class="strQQuestionNo" name="strQQuestionNo" value='@item.QuestionNo'>
                                    </text>),
                                    webGrid.Column(columnName: "strQQuestion", header: "問題描述", style: "strQQuestion",
                                    format:
                                    @<text>
                                        @item.Question
                                        <input type="hidden" class="strQQuestion" name="strQQuestion" value='@item.Question'>
                                    </text>),
                                    webGrid.Column(columnName: "strQDescription", header: "詳細說明", style: "strQDescription",
                                    format:
                                    @<text>
                                        @item.Description
                                        <input type="hidden" class="strQDescription" name="strQDescription" value='@item.Description'>
                                    </text>)
        )
        )
                        </div>
                    </div>
                    <div class="tab-pane" id="tab-check-content">
                        <div class="row">
                            <div class="form-group">
                                <label for="id_TestResult" class="col-md-3 col-lg-3 control-label">檢測結果</label>
                                <div class="col-md-21 col-lg-21">
                                    @if (@ViewBag.Type == "Details")
                                    {
                                        <textarea class="form-control" id="id_TestResult" name="TestResult" cols="40" rows="5" maxlength="255" readonly>@ViewBag.TestResult</textarea>
                                    }
                                    else
                                    {
                                        <textarea class="form-control" id="id_TestResult" name="TestResult" cols="40" rows="5" maxlength="255">@ViewBag.TestResult</textarea>
                                    }
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="form-group">
                                <label for="id_InternalRemark" class="col-md-3 col-lg-3 control-label">維修結果</label>
                                <div class="col-md-21 col-lg-21">
                                    @if (@ViewBag.Type == "Details")
                                    {
                                        <textarea class="form-control" id="id_InternalRemark" name="InternalRemark" cols="40" rows="5" maxlength="255" readonly>@ViewBag.InternalRemark</textarea>
                                    }
                                    else
                                    {
                                        <textarea class="form-control" id="id_InternalRemark" name="InternalRemark" cols="40" rows="5" maxlength="255">@ViewBag.InternalRemark</textarea>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane" id="tab-fix-content">
                        <div class="text-right">
                            @if (@ViewBag.Type == "Details")
                            {
                                <button type="button" class="btn btn-primary" id="btnRGA_D" name="action" value="btnRGA_D" aria-label="Left Align" disabled>
                                    <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 新增明細
                                </button>
                            }
                            else
                            {
                                <button type="button" class="btn btn-primary" id="btnRGA_D" name="action" value="btnRGA_D" aria-label="Left Align" tabindex="17">
                                    <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 新增明細
                                </button>
                            }
                        </div>
                        <div id="divRGA_DGrid" style="height: 100px;overflow-y: auto;">
                            @{
                                var webGridD = new WebGrid(source: (IEnumerable<BusinessLayer.Models.RGA_D>)ViewData["RGA_D"], canPage: false, canSort: false, ajaxUpdateContainerId: "divRGA_DGrid");
                            }
                            @webGridD.GetHtml(

                        tableStyle: "table table-striped table-hover",
                        columns: webGridD.Columns(
                            webGridD.Column(columnName: "", header: "動作", style: "actioncolumn",
                                format:
                                @<text>
                                        @if (@ViewBag.Type == "Details")
                                        {
                                            <a class='btn btn-link'>編輯</a>
                                            <a class='btn btn-link'>刪除</a>
                                        }
                                        else
                                        {
                                            <a class='btn btn-link' data-dismiss='modal' onclick='RGADExit(this)'>編輯</a><a class='btn btn-link' data-dismiss='modal' onclick='RemoveRGAD(this)'>刪除</a>
                                        }
                                </text>),
                                webGridD.Column(columnName: "ItemId", header: "項次", style: "ItemId",
                                format:
                                @<text>
                                    @item.ItemId
                                    <input type="hidden" class="strDItemId" name="strDItemId" value='@item.ItemId'>
                                </text>),
                                webGridD.Column(columnName: "PartNo", header: "零件品號", style: "PartNo",
                                format:
                                @<text>
                                    @item.PartNo
                                    <input type="hidden" class="strDPartNo" name="strDPartNo" value='@item.PartNo'>
                                </text>),
                                webGridD.Column(columnName: "PartName", header: "零件品名", style: "PartName",
                                format:
                                @<text>
                                    @item.PartName
                                    <input type="hidden" class="strDPartName" name="strDPartName" value='@item.PartName'>
                                </text>),
                            webGridD.Column(columnName: "QTY", header: "數量", style: "QTY",
                                format:
                                @<text>
                                    @item.QTY
                                    <input type="hidden" class="strDQTY" name="strDQTY" value='@item.QTY'>
                                </text>),
                            webGridD.Column(columnName: "Unit", header: "單位", style: "Unit",
                                format:
                                @<text>
                                    @item.Unit
                                    <input type="hidden" class="strDUnit" name="strDUnit" value='@item.Unit'>
                                </text>),
                            webGridD.Column(columnName: "Remark", header: "備註", style: "Remark",
                                format:
                                @<text>
                                    @item.Remark
                                    <input type="hidden" class="strDRemark" name="strDRemark" value='@item.Remark'>
                                </text>),
                            webGridD.Column(columnName: "Repaired", header: "維修否", style: "Repaired",
                                format:
                                @<text>
                                    @item.Repaired
                                    <input type="hidden" class="strDRepaired" name="strDRepaired" value='@item.Repaired'>
                                </text>),
                            webGridD.Column(columnName: "SourceOrderType", header: "來源單別", style: "SourceOrderType",
                                format:
                                @<text>
                                    @item.SourceOrderType
                                    <input type="hidden" class="strDSourceOrderType" name="strDSourceOrderType" value='@item.SourceOrderType'>
                                </text>),
                            webGridD.Column(columnName: "SourceOrderNo", header: "來源單號", style: "SourceOrderNo",
                                format:
                                @<text>
                                    @item.SourceOrderNo
                                    <input type="hidden" class="strDSourceOrderNo" name="strDSourceOrderNo" value='@item.SourceOrderNo'>
                                </text>),
                            webGridD.Column(columnName: "SourceItemId", header: "來源項次", style: "SourceItemId",
                                format:
                                @<text>
                                    @item.SourceItemId
                                    <input type="hidden" class="strDSourceItemId" name="strDSourceItemId" value='@item.SourceItemId'>
                                </text>)
    )
    )
                        </div>
                    </div>
                </div>
                <p style="color: red;">@ViewBag.Msg</p>
                <div class="text-right">
                    @if (@ViewBag.Type == "Edit")
                    {
                        <button type="button" class="btn btn-primary" name="action" value="Edit" onclick="btnExit()">存檔</button>
                        <button type="button" class="btn btn-primary" name="action" value="EditAgain" onclick="btnExitAgain()">存檔並新增</button>
                        <a class="btn btn-primary" href="@Url.Action("Index", "Main", null)">取消</a>
                    }
                    else if (@ViewBag.Type == "Details")
                    {
                        <a class="btn btn-primary" href="@Url.Action("Tree", "Main", new {  RGAType = @ViewBag.RGAType, RGANo = @ViewBag.RGANo })">串查</a>
                        if (@ViewBag.Confirmed == "N")
                        {
                            <button type="submit" class="btn btn-primary" name="action" value="EditDetails">編輯</button>
                        }
                        <a class="btn btn-primary" href="@Url.Action("Copy", "Main", new { RGAType = @ViewBag.RGAType, RGANo = @ViewBag.RGANo })">複製並新增</a>
                        if (@ViewBag.StatusCode == "05.已派工" && ViewBag.Confirmed == "N")
                        {
                            <button type="button" class="btn btn-primary" id="btnConfirmedY" name="action" value="btnConfirmedY" aria-label="Left Align">檢測完成</button>
                        }
                        else
                        {
                            <button type="button" class="btn btn-primary" id="btnConfirmedY" name="action" value="btnConfirmedY" aria-label="Left Align">重新檢測</button>
                        }
                        if (@ViewBag.Confirmed == "Y" && @ViewBag.Closed == "N")
                        {
                            <button type=submit class="btn btn-primary" name="action" value="CopyAddDetails">送廠申請</button>
                            <button type=submit class="btn btn-primary" name="action" value="CopyAddDetails">報價</button>
                            <button type=submit class="btn btn-primary" name="action" value="CopyAddDetails">完工</button>
                        }

                        if (@ViewBag.StatusCode == "00.未處理")
                        {
                            <a class="btn btn-primary" onclick="deleteInfo('@Url.Action("Delete", "Main", new { SupportAplOrderType = @ViewBag.SupportAplOrderType, SupportAplOrderNo = @ViewBag.SupportAplOrderNo })', '@ViewBag.SupportAplOrderNo')" href="#">刪除</a>
                        }
                        if (@ViewBag.Confirmed == "Y" && @ViewBag.Closed == "N")
                        {
                            <a class="btn btn-primary" href="@Url.Action("Confirmed", "Main", new { SupportAplOrderType = @ViewBag.SupportAplOrderType, SupportAplOrderNo = @ViewBag.SupportAplOrderNo, type = 'Y' })">完工</a>
                        }
                        <a class="btn btn-primary" href="@Url.Action("Print", "Main", new { SupportAplOrderType = @ViewBag.SupportAplOrderType, SupportAplOrderNo = @ViewBag.SupportAplOrderNo })">列印</a>
                        <a class="btn btn-primary" href="@Url.Action("Index", "Main", null)">返回列表</a>
                    }
                    else
                    {
                        <button type="button" class="btn btn-primary" name="action" value="Save" onclick="btnAdd()">存檔</button>
                        <button type=button class="btn btn-primary" name="action" value="SaveAgain" onclick="btnAddAgain()">存檔並新增</button>
                        <button type="button" class="btn btn-primary" name="action" id="btnCopyOrder">複製前單</button>
                        <a class="btn btn-primary" href="@Url.Action("Index", "Main", null)">取消</a>
                    }

                </div>
                @RenderPage("~/Areas/SERI06/Views/Shared/sure-modal.cshtml")
            </form>
        </div>
    </div>
</section>
@RenderPage("../../../../Views/Shared/RecordSelector/record_selector_OrderCategory.cshtml")
@RenderPage("../../../../Views/Shared/RecordSelector/record_selector_customer.cshtml")
@RenderPage("../../../../Views/Shared/RecordSelector/record_selector_address.cshtml")
@RenderPage("../../../../Views/Shared/RecordSelector/record_selector_contactInfo.cshtml")
@RenderPage("../../../../Views/Shared/RecordSelector/record_selector_WarrantySerial.cshtml")
@RenderPage("../../../../Views/Shared/RecordSelector/record_selector_QuestionList.cshtml")
@RenderPage("../../../../Views/Shared/RecordSelector/record_selector_PhoneService.cshtml")
@RenderPage("../../../../Views/Shared/RecordSelector/delete-dialog.cshtml")
@RenderPage("../../../../Views/Shared/RecordSelector/record_selector_product.cshtml")
@RenderPage("../../../../Views/Shared/RecordSelector/record_selector_BOM_D.cshtml")
@RenderPage("../../../../Views/Shared/RecordSelector/msg-dialog.cshtml")
@RenderPage("~/Areas/SERI06/Views/Shared/RGA_D-modal.cshtml")
