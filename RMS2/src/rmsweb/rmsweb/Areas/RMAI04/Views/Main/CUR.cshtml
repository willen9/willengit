<script type="text/javascript">
    $(function () {

        $("#btnRMAAplType").click(function () {
            $.ajax({
                url: '@Url.Action("SearchRMAApl", "Main")',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "RMAAplType": "", "RMAAplNo": "", Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divRMAAplGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divRMAAplGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectRMAApl(this)'>選擇</a>" +
                                "<td class='RMAAplTypeType'>" + Maintain[i].RMAAplType + "</td>" +
                                "<td class='OrderSNameType'>" + Maintain[i].OrderSName + "</td>" +
                                "<td class='RMAAplNoType'>" + Maintain[i].RMAAplNo + "</td>" +
                                "<td class='OrderDateType'>" + Maintain[i].OrderDate + "</td>" +
                                "<td class='CustomerIdType'>" + Maintain[i].CustomerId + "</td>" +
                                "<td class='CustomerNameType'>" + Maintain[i].CustomerName + "</td>" +
                                "<td class='CustomerTypeType'>" + Maintain[i].CustomerType + "</td>" +
                                "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                                "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                                "<td class='SerialNoType'>" + Maintain[i].SerialNo + "</td>" +
                                "</tr>");

                    }
                }
            });
            $("#txtRMAAplType").val("");
            $("#txtRMAAplNo").val("");
            $("#RMAAplPage").val("1");
            $(".record_selector_RMAApl_modal").modal();
        });

        $("#btnSearchRMAApl").click(function () {
            $.ajax({
                url: '@Url.Action("SearchRMAApl", "Main")',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "RMAAplType": $("#txtRMAAplType").val(), "RMAAplNo": $("#txtRMAAplNo").val(), Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divRMAAplGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divRMAAplGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectRMAApl(this)'>選擇</a>" +
                                "<td class='RMAAplTypeType'>" + Maintain[i].RMAAplType + "</td>" +
                                "<td class='OrderSNameType'>" + Maintain[i].OrderSName + "</td>" +
                                "<td class='RMAAplNoType'>" + Maintain[i].RMAAplNo + "</td>" +
                                "<td class='OrderDateType'>" + Maintain[i].OrderDate + "</td>" +
                                "<td class='CustomerIdType'>" + Maintain[i].CustomerId + "</td>" +
                                "<td class='CustomerNameType'>" + Maintain[i].CustomerName + "</td>" +
                                "<td class='CustomerTypeType'>" + Maintain[i].CustomerType + "</td>" +
                                "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                                "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                                "<td class='SerialNoType'>" + Maintain[i].SerialNo + "</td>" +
                                "</tr>");

                    }
                }
            });
            $("#RMAAplPage").val("1");
        });

        $("#divRMAAplGrid").scroll(function () {
            var Page = document.getElementById("RMAAplPage").value;;
            if (Page != 0) {
                var scrollTop = $(this).scrollTop();
                //var scrollHeight = $(document).height();
                //var windowHeight = $(this).height();
                if (scrollTop + 500 >= (870 - 370) * (Page - 1)) {
                    //此处是滚动条到底部时候触发的事件，在这里写要加载的数据，或者是拉动滚动条的操作
                    Page = parseInt(Page) + 1;
                    $.ajax({
                        url: '@Url.Action("SearchRMAApl", "Main")',
                        type: "POST",
                        datatype: 'JSON',
                        data: JSON.stringify({ "RMAAplType": $("#txtRMAAplType").val(), "RMAAplNo": $("#txtRMAAplNo").val(), Page: Page }),
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            var Maintain = eval(data);
                            for (var i = 0; i < Maintain.length; i++) {
                                $("#divRMAAplGrid table tbody").append("<tr>" +
                                 "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectRMAApl(this)'>選擇</a>" +
                                 "<td class='RMAAplTypeType'>" + Maintain[i].RMAAplType + "</td>" +
                                 "<td class='OrderSNameType'>" + Maintain[i].OrderSName + "</td>" +
                                 "<td class='RMAAplNoType'>" + Maintain[i].RMAAplNo + "</td>" +
                                 "<td class='OrderDateType'>" + Maintain[i].OrderDate + "</td>" +
                                 "<td class='CustomerIdType'>" + Maintain[i].CustomerId + "</td>" +
                                 "<td class='CustomerNameType'>" + Maintain[i].CustomerName + "</td>" +
                                 "<td class='CustomerTypeType'>" + Maintain[i].CustomerType + "</td>" +
                                 "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                                 "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                                 "<td class='SerialNoType'>" + Maintain[i].SerialNo + "</td>" +
                                 "</tr>");
                            }
                        }
                    });
                    $("#RMAAplPage").val(Page);
                }
            }

        });

        $("#btnCustomerId").click(function () {
            $.ajax({
                url: '@Url.Action("SearchCustomer", "Main", new { Area = "CONI02" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "Col": "", "Condition": "", "conditionValue": "", Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divCustGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divCustGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectCustomer(this)'>選擇</a>" +
                                "<td class='CustomerIdType'>" + Maintain[i].CustomerId + "</td>" +
                                "<td class='CustomerNameType'>" + Maintain[i].CustomerName + "</td>" +
                                "<td class='CustomerTypeType'>" + Maintain[i].CustomerType + "</td>" +
                                "<td class='ContactType'>" + Maintain[i].Contact + "</td>" +
                                "<td class='TelNoType'>" + Maintain[i].TelNo + "</td>" +
                                "<td class='SalesType'>" + Maintain[i].SalesName + "</td><td><input type='hidden' class='SalesIDType' name='sales' value='"
                                + Maintain[i].Sales + "'>" + "</td>" +
                                "<td><input type='hidden' class='CurrencyIdType' name='version' value='" + Maintain[i].CurrencyId + "'>" + "</td>" +
                                "<td><input type='hidden' class='TaxRateType' name='version' value='" + Maintain[i].TaxRate + "'>" + "</td>" +
                                "<td><input type='hidden' class='FaxNoType' name='version' value='" + Maintain[i].FaxNo + "'>" + "</td>" +
                                "<td><input type='hidden' class='EmailType' name='version' value='" + Maintain[i].Email + "'>" + "</td>" +
                                "<td><input type='hidden' class='AddressSNameType' name='version' value='" + Maintain[i].AddressSName + "'>" + "</td>" +
                                "<td><input type='hidden' class='AddressType' name='version' value='" + Maintain[i].Address + "'>" + "</td>" +
                                "<td><input type='hidden' class='RemarkType' name='version' value='" + Maintain[i].Remark + "'>" + "</td>" +
                                "<td><input type='hidden' class='CustomerFNameType' name='version' value='" + Maintain[i].CustomerFName + "'>" + "</td>" +
                                "</tr>");

                    }
                }
            });
            $("#txtCustomerId").val("");
            $("#txtCustomerName").val("");
            $("#CustPage").val("1");
            $(".record-selector-customer-modal").modal();
        });

        $("#btncustomerInfo").click(function () {
            $.ajax({
                url: '@Url.Action("SearchCustomer", "Main", new { Area = "CONI02" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "CustomerId": $("#txtCustomerId").val(), "Col": $("#addCustomer_Col").val(), "Condition": $("#addCustomer_Condition").val(), "conditionValue": $("#addCustomer_conditionValue").val(), Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divCustGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divCustGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectCustomer(this)'>選擇</a>" +
                                "<td class='CustomerIdType'>" + Maintain[i].CustomerId + "</td>" +
                                "<td class='CustomerNameType'>" + Maintain[i].CustomerName + "</td>" +
                                "<td class='CustomerTypeType'>" + Maintain[i].CustomerType + "</td>" +
                                "<td class='ContactType'>" + Maintain[i].Contact + "</td>" +
                                "<td class='TelNoType'>" + Maintain[i].TelNo + "</td>" +
                                "<td class='SalesType'>" + Maintain[i].SalesName + "</td><td><input type='hidden' class='SalesIDType' name='sales' value='"
                                + Maintain[i].Sales + "'>" + "</td>" +
                                "<td><input type='hidden' class='CurrencyIdType' name='version' value='" + Maintain[i].CurrencyId + "'>" + "</td>" +
                                "<td><input type='hidden' class='TaxRateType' name='version' value='" + Maintain[i].TaxRate + "'>" + "</td>" +
                                "<td><input type='hidden' class='FaxNoType' name='version' value='" + Maintain[i].FaxNo + "'>" + "</td>" +
                                "<td><input type='hidden' class='EmailType' name='version' value='" + Maintain[i].Email + "'>" + "</td>" +
                                "<td><input type='hidden' class='AddressSNameType' name='version' value='" + Maintain[i].AddressSName + "'>" + "</td>" +
                                "<td><input type='hidden' class='AddressType' name='version' value='" + Maintain[i].Address + "'>" + "</td>" +
                                "<td><input type='hidden' class='RemarkType' name='version' value='" + Maintain[i].Remark + "'>" + "</td>" +
                                "<td><input type='hidden' class='CustomerFNameType' name='version' value='" + Maintain[i].CustomerFName + "'>" + "</td>" +
                                "</tr>");
                    }
                }
            });
            $("#CustPage").val("1");
        });

        $("#divCustGrid").scroll(function () {
            var Page = document.getElementById("CustPage").value;;
            if (Page != 0) {
                var scrollTop = $(this).scrollTop();
                //var scrollHeight = $(document).height();
                //var windowHeight = $(this).height();
                if (scrollTop + 500 >= (870 - 370) * (Page - 1)) {
                    //此处是滚动条到底部时候触发的事件，在这里写要加载的数据，或者是拉动滚动条的操作
                    Page = parseInt(Page) + 1;
                    $.ajax({
                        url: '@Url.Action("SearchCustomer", "Main", new { Area = "CONI02" })',
                        type: "POST",
                        datatype: 'JSON',
                        data: JSON.stringify({ "CustomerId": $("#txtCustomerId").val(), "Col": $("#addCustomer_Col").val(), "Condition": $("#addCustomer_Condition").val(), "conditionValue": $("#addCustomer_conditionValue").val(), Page: Page }),
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            var Maintain = eval(data);
                            for (var i = 0; i < Maintain.length; i++) {
                                $("#divCustGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectCustomer(this)'>選擇</a>" +
                                "<td class='CustomerIdType'>" + Maintain[i].CustomerId + "</td>" +
                                "<td class='CustomerNameType'>" + Maintain[i].CustomerName + "</td>" +
                                "<td class='CustomerTypeType'>" + Maintain[i].CustomerType + "</td>" +
                                "<td class='ContactType'>" + Maintain[i].Contact + "</td>" +
                                "<td class='TelNoType'>" + Maintain[i].TelNo + "</td>" +
                                "<td class='SalesType'>" + Maintain[i].SalesName + "</td><td><input type='hidden' class='SalesIDType' name='sales' value='"
                                + Maintain[i].Sales + "'>" + "</td>" +
                                "<td><input type='hidden' class='CurrencyIdType' name='version' value='" + Maintain[i].CurrencyId + "'>" + "</td>" +
                                "<td><input type='hidden' class='TaxRateType' name='version' value='" + Maintain[i].TaxRate + "'>" + "</td>" +
                                "<td><input type='hidden' class='FaxNoType' name='version' value='" + Maintain[i].FaxNo + "'>" + "</td>" +
                                "<td><input type='hidden' class='EmailType' name='version' value='" + Maintain[i].Email + "'>" + "</td>" +
                                "<td><input type='hidden' class='AddressSNameType' name='version' value='" + Maintain[i].AddressSName + "'>" + "</td>" +
                                "<td><input type='hidden' class='AddressType' name='version' value='" + Maintain[i].Address + "'>" + "</td>" +
                                "<td><input type='hidden' class='RemarkType' name='version' value='" + Maintain[i].Remark + "'>" + "</td>" +
                                "<td><input type='hidden' class='CustomerFNameType' name='version' value='" + Maintain[i].CustomerFName + "'>" + "</td>" +
                                "</tr>");
                            }
                        }
                    });
                    $("#CustPage").val(Page);
                }
            }

        });

        $("#btnProductNo").click(function () {
            $.ajax({
                url: '@Url.Action("SearchProduct", "Main", new { Area = "CONI02" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "ProductNo": $("#id_ProductNo").val(), "Col": "", "Condition": "", "conditionValue": "", Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divProductGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divProductGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectProduct(this)'>選擇</a>" +
                                "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                                "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                                "<td class='SpecificationType'>" + Maintain[i].Specification + "</td>" +
                                "<td class='UnitType'>" + Maintain[i].Unit + "</td>" +
                                "<td class='ProductTypeId1NameType'>" + Maintain[i].ProductTypeId1Name + "</td>" +
                                "<td class='VendorNameType'>" + Maintain[i].VendorName + "</td>" +
                                "</tr>");

                    }
                }
            });
            $("#txtProductNo").val("");
            $("#txtProductName").val("");
            $("#ProductPage").val("1");
            $(".record-selector-product-modal").modal();
        });

        $("#btnSearchProduct").click(function () {
            $.ajax({
                url: '@Url.Action("SearchProduct", "Main",new { Area = "CONI02" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "ProductNo": $("#txtProductNo").val(), "Col": $("#addProduct_Col").val(), "Condition": $("#addProduct_Condition").val(), "conditionValue": $("#addProduct_conditionValue").val(), Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divProductGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divProductGrid table tbody").append("<tr>" +
                                "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectProduct(this)'>選擇</a>" +
                                "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                                "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                                "<td class='SpecificationType'>" + Maintain[i].Specification + "</td>" +
                                "<td class='UnitType'>" + Maintain[i].Unit + "</td>" +
                                "<td class='ProductTypeId1NameType'>" + Maintain[i].ProductTypeId1Name + "</td>" +
                                "<td class='VendorNameType'>" + Maintain[i].VendorName + "</td>" +
                                "</tr>");
                    }
                }
            });
            $("#ProductPage").val("1");
        });

        $("#divProductGrid").scroll(function () {
            var Page = document.getElementById("ProductPage").value;;
            if (Page != 0) {
                var scrollTop = $(this).scrollTop();
                //var scrollHeight = $(document).height();
                //var windowHeight = $(this).height();
                if (scrollTop + 500 >= (870 - 370) * (Page - 1)) {
                    //此处是滚动条到底部时候触发的事件，在这里写要加载的数据，或者是拉动滚动条的操作
                    Page = parseInt(Page) + 1;
                    $.ajax({
                        url: '@Url.Action("SearchProduct", "Main", new { Area = "CONI02" })',
                        type: "POST",
                        datatype: 'JSON',
                        data: JSON.stringify({ "ProductNo": $("#txtProductNo").val(), "Col": $("#addProduct_Col").val(), "Condition": $("#addProduct_Condition").val(), "conditionValue": $("#addProduct_conditionValue").val(), Page: Page }),
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            var Maintain = eval(data);
                            for (var i = 0; i < Maintain.length; i++) {
                                $("#divProductGrid table tbody").append("<tr>" +
                                    "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectProduct(this)'>選擇</a>" +
                                    "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                                    "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                                    "<td class='SpecificationType'>" + Maintain[i].Specification + "</td>" +
                                    "<td class='UnitType'>" + Maintain[i].Unit + "</td>" +
                                    "<td class='ProductTypeId1NameType'>" + Maintain[i].ProductTypeId1Name + "</td>" +
                                    "<td class='VendorNameType'>" + Maintain[i].VendorName + "</td>" +
                                    "</tr>");
                            }
                        }
                    });
                    $("#ProductPage").val(Page);
                }
            }

        });

        $("#btnSerialNo").click(function () {
            $.ajax({
                url: '@Url.Action("SearchWarrantySerialNo", "Main",new { Area = "SERI06" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "ProductNo": $("#ProductNo").val(), "SerialNo": "", "ChangeDate": $("#id_OrderDate").val(), "WarrantyType": "23", Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divWarrantySerialNoGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divWarrantySerialNoGrid table tbody").append("<tr>" +
                            "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectSerialNo(this)'>選擇</a>" +
                            "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                            "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                            "<td class='SerialNoType'>" + Maintain[i].SerialNo + "</td>" +
                            "<td class='ChangeDateType'>" + Maintain[i].ChangeDate + "</td>" +
                            "<td class='TargetIdType'>" + Maintain[i].TargetId + "</td>" +
                            "<td class='TargetNameType'>" + Maintain[i].TargetName + "</td>" +
                            "<td class='WarrantySDateType'>" + Maintain[i].WarrantySDate + "</td>" +
                            "<td class='WarrantyEDateType'>" + Maintain[i].WarrantyEDate + "</td>" +
                            "<td class='WarrantyTypeType'>" + Maintain[i].WarrantyType + "</td>" +
                            "</tr>");

                    }
                }
            });
            $("#txtWarrantyProductNo").val($("#ProductNo").val());
            $("#txtWarrantySerialNo").val("");
            $("#WarrantySerialNoPage").val("1");
            $(".record-selector-WarrantySerialNo-modal").modal();

        });

        $("#btnWarrantySerialNo").click(function () {
            $.ajax({
                url: '@Url.Action("SearchWarrantySerialNo", "Main", new { Area = "SERI06" })',
                type: "POST",
                datatype: 'JSON',
                data: JSON.stringify({ "ProductNo": $("#txtWarrantyProductNo").val(), "SerialNo": $("#txtWarrantySerialNo").val(), "ChangeDate": $("#id_OrderDate").val(), "WarrantyType": "23", Page: 1 }),
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    $("#divWarrantySerialNoGrid table tbody").empty();
                    var Maintain = eval(data);
                    for (var i = 0; i < Maintain.length; i++) {
                        $("#divWarrantySerialNoGrid table tbody").append("<tr>" +
                            "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectSerialNo(this)'>選擇</a>" +
                            "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                            "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                            "<td class='SerialNoType'>" + Maintain[i].SerialNo + "</td>" +
                            "<td class='ChangeDateType'>" + Maintain[i].ChangeDate + "</td>" +
                            "<td class='TargetIdType'>" + Maintain[i].TargetId + "</td>" +
                            "<td class='TargetNameType'>" + Maintain[i].TargetName + "</td>" +
                            "<td class='WarrantySDateType'>" + Maintain[i].WarrantySDate + "</td>" +
                            "<td class='WarrantyEDateType'>" + Maintain[i].WarrantyEDate + "</td>" +
                            "<td class='WarrantyTypeType'>" + Maintain[i].WarrantyType + "</td>" +
                            "</tr>");
                    }
                }
            });
            $("#WarrantySerialNoPage").val("1");
        });

        $("#divWarrantySerialNoGrid").scroll(function () {
            var Page = document.getElementById("WarrantySerialNoPage").value;;
            if (Page != 0) {
                var scrollTop = $(this).scrollTop();
                //var scrollHeight = $(document).height();
                //var windowHeight = $(this).height();
                if (scrollTop + 500 >= (870 - 370) * (Page - 1)) {
                    //此处是滚动条到底部时候触发的事件，在这里写要加载的数据，或者是拉动滚动条的操作
                    Page = parseInt(Page) + 1;
                    $.ajax({
                        url: '@Url.Action("SearchWarrantySerialNo", "Main", new { Area = "SERI06" })',
                        type: "POST",
                        datatype: 'JSON',
                        data: JSON.stringify({ "ProductNo": $("#txtWarrantyProductNo").val(), "SerialNo": $("#txtWarrantySerialNo").val(), "ChangeDate": $("#id_OrderDate").val(), "WarrantyType": "23", Page: Page }),
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            var Maintain = eval(data);
                            for (var i = 0; i < Maintain.length; i++) {
                                $("#divWarrantySerialNoGrid table tbody").append("<tr>" +
                                    "<td class='actioncolumn'><a class='btn btn-link' data-dismiss='modal' onclick='SelectSerialNo(this)'>選擇</a>" +
                                    "<td class='ProductNoType'>" + Maintain[i].ProductNo + "</td>" +
                                    "<td class='ProductNameType'>" + Maintain[i].ProductName + "</td>" +
                                    "<td class='SerialNoType'>" + Maintain[i].SerialNo + "</td>" +
                                    "<td class='ChangeDateType'>" + Maintain[i].ChangeDate + "</td>" +
                                    "<td class='TargetIdType'>" + Maintain[i].TargetId + "</td>" +
                                    "<td class='TargetNameType'>" + Maintain[i].TargetName + "</td>" +
                                    "<td class='WarrantySDateType'>" + Maintain[i].WarrantySDate + "</td>" +
                                    "<td class='WarrantyEDateType'>" + Maintain[i].WarrantyEDate + "</td>" +
                                    "<td class='WarrantyTypeType'>" + Maintain[i].WarrantyType + "</td>" +
                                    "</tr>");
                            }
                        }
                    });
                    $("#WarrantySerialNoPage").val(Page);
                }
            }
        });
    })

    function SelectProduct(id) {
        $("#ProductNo").val($(id).closest('tr').find(".ProductNoType").html());        //品號
        $("#ProductName").val($(id).closest('tr').find(".ProductNameType").html());     //品名
    }

    function SelectCustomer(id) {
        $("#CustomerId").val($(id).closest('tr').find(".CustomerIdType").html());        //客戶代號
        $("#CustomerName").html($(id).closest('tr').find(".CustomerNameType").html());     //客戶名稱
        $("#CustomerType").val($(id).closest('tr').find(".CustomerTypeType").html());     //客戶形態
    };


    function SelectSerialNo(id) {
        $("#ProductNo").val($(id).closest('tr').find(".ProductNoType").html());        //品號
        $("#ProductName").val($(id).closest('tr').find(".ProductNameType").html());     //品名
        $("#SerialNo").val($(id).closest('tr').find(".SerialNoType").html());        //序號
        $("#CustomerId").val($(id).closest('tr').find(".TargetIdType").html());        //客戶代號
        $("#customername").html($(id).closest('tr').find(".TargetNameType").html());     //客戶名稱
        $.ajax({
            url: '@Url.Action("SearchCustomerInfo", "Main", new { Area = "CONI02" })',
            data: JSON.stringify({ "CustomerId": $("#CustomerId").val().trim() }),
            type: 'POST',
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                $('#CustomerType').val(data.CustomerType);
            }, error: function () {
                $('#CustomerType').val("");
            }
        })
        $("#WarrantyStartDate").val($(id).closest('tr').find(".WarrantySDateType").html());     //品名
        $("#WarrantyExpiryDate").val($(id).closest('tr').find(".WarrantyEDateType").html());     //品名
        if ($(id).closest('tr').find(".WarrantySDateType").html() < $("#id_OrderDate").val()
        && $("#id_OrderDate").val() < $(id).closest('tr').find(".WarrantyEDateType").html())        //續約
        {
            document.getElementById('UnderWarranty').checked = true;
        } else {
            document.getElementById('UnderWarranty').checked = false;
        }
        $.ajax({
            url: '@Url.Action("SearchWarrantyDInfo", "Main", new { Area = "SERI06" })',
            data: JSON.stringify({ "ProductNo": $("#ProductNo").val(), "SerialNo": $("#SerialNo").val(), "ChangeDate": "", "WarrantyType": "01" }),
            type: 'POST',
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                $("#VendorWarrantyStartDate").val(data.WarrantySDate);     //品名
                $("#VendorWarrantyExpiryDate").val(data.WarrantyEDate);     //品名
            }
        })

    }

    function SelectRMAApl(id) {
        $("#RMAAplType").val($(id).closest('tr').find(".RMAAplTypeType").html());        //品號
        $("#RMAAplNo").val($(id).closest('tr').find(".RMAAplNoType").html());     //品名
        $.ajax({
            url: '@Url.Action("SearchRMAAplInfo", "Main")',
            data: JSON.stringify({ "RMAAplType": $("#RMAAplType").val().trim(), "RMAAplNo": $("#RMAAplNo").val().trim() }),
            type: 'POST',
            contentType: 'application/json; charset=utf-8',
            success: function (data) {
                $('#Version').val(data.Version);
                $('#NoOfPrints').val(data.NoOfPrints);
                $('#SourceOrderType').val(data.SourceOrderType);
                $('#SourceOrderNo').val(data.SourceOrderNo);
                $('#Remark').val(data.Remark);
                $('#CustomerId').val(data.CustomerId);
                $('#TestResult').val(data.TestResult);
                $('#OptionDetail').val(data.OptionDetail);
            }, error: function () {
                $('#CustomerType').val("");
            }
        }) 
    }

    function btnAdd() {
        //if (document.getElementById("RMAAplType").value == "") {
        //    $("#msg_information").html("單別不能為空！");
        //    $('.msg-modal-lg').modal();
        //    return;
        //}
        //if (document.getElementById("RMAAplNo").value == "") {
        //    $("#msg_information").html("單號不能為空！");
        //    $('.msg-modal-lg').modal();
        //    return;
        //}
        //if (document.getElementById("SerialNo").value == "") {
        //    $("#msg_information").html("序號不能為空！");
        //    $('.msg-modal-lg').modal();
        //    return;
        //}

        //if (document.getElementById("CheckExOrder").value == "Y") {
        //    if (document.getElementById("SourceOrderType").value == "") {
        //        $("#msg_information").html("單別需要核對來源帶單！");
        //        $('.msg-modal-lg').modal();
        //        return;
        //    }
        //}
        //if (document.getElementById("AutoConfirm").value == "Y") {
        //    var myDate = new Date();
        //    var year = myDate.getFullYear();
        //    var month = myDate.getMonth() + 1;
        //    var date = myDate.getDate();
        //    if (month.toString().length == 1) {
        //        month = "0" + month;
        //    }
        //    if (date.toString().length == 1) {
        //        date = "0" + date.toString();
        //    }
        //    $("#id_Add_sureConfirmDate").val(year + "/" + month + "/" + date);
        //    $(".Add-sure-modal").modal();
        //}
        //else {
            $.ajax({
                url: '@Url.Action("Add", "Main")',
                data: $('#from-RMAApl').serialize(),
                type: 'POST',
                contentType: 'application/x-www-form-urlencoded',
                success: function (data) {
                    var strData = data.split('-');
                    if (strData[0] == "NO") {
                        $("#msg_information").html(strData[1]);
                        $('.msg-modal-lg').modal();
                    } else {
                        window.location.href = '@Url.Action("Index", "Main")';
                    }

                }
            })
        //}

    };

    function btnAddAgain() {
        if (document.getElementById("RMAAplType").value == "") {
            $("#msg_information").html("單別不能為空！");
            $('.msg-modal-lg').modal();
            return;
        }
        if (document.getElementById("RMAAplNo").value == "") {
            $("#msg_information").html("單號不能為空！");
            $('.msg-modal-lg').modal();
            return;
        }
        if (document.getElementById("SerialNo").value == "") {
            $("#msg_information").html("序號不能為空！");
            $('.msg-modal-lg').modal();
            return;
        }
        if (document.getElementById("CheckExOrder").value == "Y") {
            if (document.getElementById("SourceOrderType").value == "") {
                $("#msg_information").html("單別需要核對來源帶單！");
                $('.msg-modal-lg').modal();
                return;
            }
        }
        if (document.getElementById("AutoConfirm").value == "Y") {
            var myDate = new Date();
            var year = myDate.getFullYear();
            var month = myDate.getMonth() + 1;
            var date = myDate.getDate();
            if (month.toString().length == 1) {
                month = "0" + month;
            }
            if (date.toString().length == 1) {
                date = "0" + date.toString();
            }
            $("#id_Add_sureConfirmDate").val(year + "/" + month + "/" + date);
            $("#addAgin").val("1");
            $(".Add-sure-modal").modal();
        }
        else {
            $.ajax({
                url: '@Url.Action("Add", "Main")',
                data: $('#from-RMAApl').serialize(),
                type: 'POST',
                contentType: 'application/x-www-form-urlencoded',
                success: function (data) {
                    var strData = data.split('-');
                    if (strData[0] == "NO") {
                        $("#msg_information").html(strData[1]);
                        $('.msg-modal-lg').modal();
                    } else {
                        window.location.href = '@Url.Action("CUR", "Main")';
                    }

                }
            })
        }
    };

    function btnExit() {
        if (document.getElementById("SerialNo").value == "") {
            $("#msg_information").html("序號不能為空！");
            $('.msg-modal-lg').modal();
            return;
        }
        $.ajax({
            url: '@Url.Action("Exit", "Main")',
            data: $('#from-RMAApl').serialize(),
            type: 'POST',
            contentType: 'application/x-www-form-urlencoded',
            success: function (data) {
                var strData = data.split('-');
                if (strData[0] == "NO") {
                    $("#msg_information").html(strData[1]);
                    $('.msg-modal-lg').modal();
                } else {
                    window.location.href = '@Url.Action("Index", "Main")';
                }

            }
        })
    };

    function btnExitAgain() {
        if (document.getElementById("SerialNo").value == "") {
            $("#msg_information").html("序號不能為空！");
            $('.msg-modal-lg').modal();
            return;
        }
        $.ajax({
            url: '@Url.Action("Exit", "Main")',
            data: $('#from-RMAApl').serialize(),
            type: 'POST',
            contentType: 'application/x-www-form-urlencoded',
            success: function (data) {
                var strData = data.split('-');
                if (strData[0] == "NO") {
                    $("#msg_information").html(strData[1]);
                    $('.msg-modal-lg').modal();
                } else {
                    window.location.href = '@Url.Action("CUR", "Main")';
                }

            }
        })
    };
</script>
<section class="content-header">
    <h1>送廠申請變更單維護</h1>
</section>
<section class="content">
    <div class="panel panel-default">
        <div class="panel-heading"><i class="fa fa-pencil fa-fw"></i> Application</div>
        <div class="panel-body">
            <form id="from-RMAApl" method="post">
                <div class="row">
                    <div class="form-group">
                        <label for="id_RMAAplType" class="col-md-3 col-lg-3 control-label">單別</label>
                        <div class="col-md-5 col-lg-5">
                            <div class="input-group">
                                <input type="text" class="form-control" id="RMAAplType" name="RMAAplType" value="@ViewBag.RMAAplType" maxlength="5" />
                                <span class="input-group-addon" id="btnRMAAplType" style="cursor:pointer;"><span class="fa fa-hand-pointer-o"></span></span>
                            </div>
                        </div>
                        <label for="id_OrderDate" class="col-md-3 col-lg-3 control-label">單據日期</label>
                        <div class="col-md-5 col-lg-5 date" data-date="" data-date-format="yyyy/mm/dd" data-link-field="id_orderdate" data-link-format="yyyy/mm/dd">
                            <div class="input-group">
                                <input type="text" class="form-control" name="OrderDate" readonly="readonly" value="@ViewBag.OrderDate" />
                                <span class="input-group-addon" id="basic-addon2"><span class="glyphicon glyphicon-calendar"></span></span>
                            </div>
                        </div>
                        <label for="id_Confirmed" class="col-md-3 col-lg-3 control-label">確認碼</label>
                        <div class="col-md-5 col-lg-5">
                            <select class="form-control" name="Confirmed" disabled></select>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label for="id_RMAAplNo" class="col-md-3 col-lg-3 control-label">單號</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="RMAAplNo" name="RMAAplNo" maxlength="11" value="@ViewBag.RMAAplNo" />
                        </div>
                        <label for="id_OldVersion" class="col-md-3 col-lg-3 control-label">版次</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="OldVersion" name="OldVersion" value="@ViewBag.OldVersion" maxlength="4" />
                        </div>
                        <label for="id_UserGroup" class="col-md-3 col-lg-3 control-label">建立人員</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="UserGroup" name="UserGroup" value="@ViewBag.UserGroup" maxlength=" 50" />
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label for="id_SourceOrderNo" class="col-md-3 col-lg-3 control-label">來源單號</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="SourceOrderType" name="SourceOrderType" style="width: 40%; display: inline;" maxlength="5" value="@ViewBag.SourceOrderType" readonly/>
                            <input type="text" class="form-control" id="SourceOrderNo" name="SourceOrderNo" style="width: 55%; display: inline;" maxlength="11" value="@ViewBag.SourceOrderNo" readonly/>
                        </div>
                        <label for="id_NoOfPrints" class="col-md-3 col-lg-3 control-label">列印次數</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="NoOfPrints" name="NoOfPrints" value="@ViewBag.NoOfPrints" />
                        </div>
                        <label for="id_ConfirmedDate" class="col-md-3 col-lg-3 control-label">變更日期</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="ConfirmedDate" name="ConfirmedDate" value="@ViewBag.ConfirmedDate" maxlength="8" />
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label for="id_Remark" class="col-md-3 col-lg-3 control-label">備註</label>
                        <div class="col-md-13 col-lg-13">
                            <input type="text" class="form-control" id="Remark" name="Remark" value="@ViewBag.Remark" maxlength="255" />
                        </div>
                        <label for="id_Confirmor" class="col-md-3 col-lg-3 control-label">變更人員</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="Confirmor" name="Confirmor" value="@ViewBag.Confirmor" maxlength="50">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="id_ChangeReason" class="col-md-3 col-lg-3 control-label">變更原因</label>
                        <div class="col-md-13 col-lg-13">
                            <input type="text" class="form-control" id="ChangeReason" name="ChangeReason" value="@ViewBag.ChangeReason" maxlength="255" />
                        </div>
                        <label for="id_IsClosed" class="col-md-3 col-lg-3 control-label">指定結案</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="checkbox" id="IsClosed" name="IsClosed"/>
                        </div>
                    </div>
                </div>                    
                <h5>申請資訊</h5>
                <hr />
                <div class="row">
                    <div class="form-group">
                        <label for="id_CustomerId" class="col-md-3 col-lg-3 control-label">客戶代號</label>
                        <div class="col-md-5 col-lg-5">
                            <div class="input-group">
                                <input type="text" class="form-control" id="CustomerId" name="CustomerId" value="@ViewBag.CustomerId" maxlength="10" />
                                <span class="input-group-addon" id="btnCustomerId" style="cursor:pointer;"><span class="fa fa-hand-pointer-o"></span></span>
                            </div>                          
                        </div>
                        <label for="id_Customer" class="col-md-3 col-lg-3 control-label">客戶形態</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="Customer" name="Customer" value="@ViewBag.Customer" />
                        </div>
                        <label for="id_UnderWarranty" class="col-md-3 col-lg-3 control-label">客戶保固</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="UnderWarranty" name="UnderWarranty" value="@ViewBag.UnderWarranty" />
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label for="ProductNo" class="col-md-3 col-lg-3 control-label">維修品號</label>
                        <div class="col-md-5 col-lg-5">
                            <div class="input-group">
                                <input type="text" class="form-control" id="ProductNo" name="ProductNo" value="@ViewBag.ProductNo" maxlength="40" />
                                <span class="input-group-addon" id="btnProductNo" style="cursor:pointer;"><span class="fa fa-hand-pointer-o"></span></span>
                            </div>
                        </div>
                        <label for="id_SerialNo" class="col-md-3 col-lg-3 control-label">序號</label>
                        <div class="col-md-5 col-lg-5">
                            <div class="input-group">
                                <input type="text" class="form-control" id="SerialNo" name="SerialNo" value="@ViewBag.SerialNo" maxlength="30" />
                                <span class="input-group-addon" id="btnSerialNo" style="cursor:pointer;"><span class="fa fa-hand-pointer-o"></span></span>
                            </div>
                        </div>
                        <label for="id_Returned" class="col-md-3 col-lg-3 control-label">覆修</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="Returned" name="Returned" value="@ViewBag.Returned" />
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label for="id_ProductName" class="col-md-3 col-lg-3 control-label">維修品名</label>
                        <div class="col-md-5 col-lg-5">
                            <input type="text" class="form-control" id="ProductName" name="ProductName" value="@ViewBag.ProductName" />
                        </div>
                        <label for="id_VendorWarranty" class="col-md-3 col-lg-3 control-label">原廠保固</label>
                        <div class="col-md-13 col-lg-13">
                            <input type="text" class="form-control" id="VendorWarrantyStartDate" name="VendorWarrantyStartDate" style="width: 45%; display: inline;" value="@ViewBag.VendorWarrantyStartDate" />
                            <span style="display:inline;">至</span>
                            <input type="text" class="form-control" id="VendorWarrantyExpiryDate" name="VendorWarrantyExpiryDate" style="width: 45%; display: inline;" value="@ViewBag.VendorWarrantyExpiryDate" />
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label for="id_OptionDetail" class="col-md-3 col-lg-3 control-label">配件說明</label>
                        <div class="col-md-21 col-lg-21">
                            <input type="text" class="form-control" id="OptionDetail" name="OptionDetail" value="@ViewBag.OptionDetail" maxlength="100" />
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group">
                        <label for="id_Remark" class="col-md-3 col-lg-3 control-label">入件說明</label>
                        <div class="col-md-21 col-lg-21">
                            <input type="text" class="form-control" id="Remark" name="Remark" value="@ViewBag.Remark" maxlength="255" />
                        </div>
                    </div>
                </div>
                 
                <h5>檢測內容</h5>
                <hr />
                <div class="row">
                    <div class="form-group">
                        <label for="id_TestResult" class="col-md-3 col-lg-3 control-label">檢測結果</label>
                        <div class="col-md-21 col-lg-21">
                            <textarea class="form-control" id="TestResult" name="TestResult" cols="40" rows="5">
                                @ViewBag.TestResult
                            </textarea>
                        </div>
                    </div>
		            <div class="text-right">
                     @if (@ViewBag.Type == "Edit")
                    {
                        <button type="button" class="btn btn-primary" name="action" value="Edit" onclick="btnExit()">存檔</button>
                                    <button type="button" class="btn btn-primary" name="action" value="EditAgain" onclick="btnExitAgain()">存檔並新增</button>
                                    <a class="btn btn-primary" href="@Url.Action("Index", "Main", null)">取消</a>
                    }
                    else if (@ViewBag.Type == "Details")
                    {
                    <button type="button" class="btn btn-primary" name="action" value="">編輯</button>
                    <button type="button" class="btn btn-primary" name="action" value="">複製并新增</button>
                    <button type="button" class="btn btn-primary" name="action" value="">確認</button>
                    <button type="button" class="btn btn-primary" name="action" value="">刪除</button>
                    <button type="button" class="btn btn-primary" name="action" value="">列印</button>
                    <button type="button" class="btn btn-primary" name="action" value="">返回列表</button>
                     }
                     else
                     {
                        <button type="button" class="btn btn-primary" name="action" value="Save" onclick="btnAdd()">存檔</button>
                        <button type=button class="btn btn-primary" name="action" value="SaveAgain" onclick="btnAddAgain()">存檔並新增</button>
                        <button type="button" class="btn btn-primary" name="action" id="btnCopyOrder">複製前單</button>
                        <a class="btn btn-primary" href="@Url.Action("Index", "Main", null)">取消</a>
                     }
		        </div>
            </form>
        </div>
    </div>
</section>
@RenderPage("../../../../Views/Shared/RecordSelector/delete-dialog.cshtml")
@RenderPage("../../../../Views/Shared/RecordSelector/msg-dialog.cshtml")
@RenderPage("../../../../Views/Shared/RecordSelector/record_selector_customer.cshtml")
@RenderPage("../../../../Views/Shared/RecordSelector/record_selector_WarrantySerial.cshtml")
@RenderPage("../../../../Views/Shared/RecordSelector/record_selector_product.cshtml")
@RenderPage("../../../../Views/Shared/RecordSelector/record_selector_RMAApl.cshtml")
